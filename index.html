<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Iftar Tracker BD</title>
<meta name="description" content="‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂‡ßá‡¶∞ ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶è‡¶≤‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶á‡¶´‡¶§‡¶æ‡¶∞‡ßá‡¶∞ ‡¶Æ‡ßá‡¶®‡ßç‡¶Ø‡ßÅ ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶∂‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§">
<meta name="theme-color" content="#065f46">
<link rel="manifest" href="/manifest.json">
<!-- Leaflet & MarkerCluster -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.css"/>
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.Default.css"/>
<script src="https://unpkg.com/leaflet.markercluster/dist/leaflet.markercluster.js"></script>
<!-- Supabase JS for Realtime -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<!-- FontAwesome & Tailwind & Confetti -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<!-- Umami Analytics -->
<script src="https://cloud.umami.is/script.js" data-website-id="467e3a3f-ddd4-442a-ac05-fe77dc9501e3"></script>

<style>
/* üíé Advanced Glassmorphism & UI Styles */
body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #eef2ff; padding-bottom: 2rem; overflow-x: hidden; }
.glass-panel { background: rgba(255, 255, 255, 0.75); backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px); border: 1px solid rgba(255, 255, 255, 0.9); }
.glass-header { background: rgba(4, 120, 87, 0.9); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border-bottom: 1px solid rgba(16, 185, 129, 0.4); }

/* üî• Google Maps Style Blue Dot for Current Location */
.pulse-blue-dot {
    width: 20px; height: 20px;
    background-color: #4285F4;
    border-radius: 50%;
    border: 3px solid white;
    box-shadow: 0 0 10px rgba(66, 133, 244, 0.8);
    position: relative;
    transform: translate(-50%, -50%);
}
.pulse-blue-dot::after {
    content: '';
    position: absolute;
    width: 40px; height: 40px;
    background-color: rgba(66, 133, 244, 0.4);
    border-radius: 50%;
    top: -13px; left: -13px;
    animation: pulse 1.5s infinite ease-in-out;
}
@keyframes pulse { 0% {transform: scale(0.5); opacity: 1;} 100% {transform: scale(1.5); opacity: 0;} }

/* üî• Dynamic Floating Pin (Scales on Zoom) */
.map-text-marker { display: flex; flex-direction: column; align-items: center; justify-content: center; width: 160px; transform-origin: bottom center; cursor: pointer; transition: transform 0.3s ease; transform: translate(-50%, -100%); }
.map-text-marker .pin-icon { font-size: 38px; color: #ef4444; filter: drop-shadow(0 8px 6px rgba(0,0,0,0.6)); animation: bounceSoft 2.5s ease-in-out infinite; }
.map-text-marker .info-text { font-size: 13px; font-weight: 900; color: #fff; background: rgba(6, 78, 59, 0.85); backdrop-filter: blur(4px); padding: 2px 8px; border-radius: 8px; border: 1px solid #10b981; margin-top: -8px; line-height: 1.2; text-align: center; box-shadow: 0 4px 6px rgba(0,0,0,0.3); max-width: 140px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}
.map-text-marker .menu-text { font-size: 11px; font-weight: 800; color: #fde047; text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 0px 3px 6px rgba(0,0,0,0.9); margin-top: 3px; text-align: center; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; line-height: 1.3; }

/* Dynamic Zoom Scaling CSS */
#map[data-zoom="6"] .map-text-marker, #map[data-zoom="7"] .map-text-marker, #map[data-zoom="8"] .map-text-marker { transform: translate(-50%, -100%) scale(0.2); opacity: 0.5; }
#map[data-zoom="9"] .map-text-marker, #map[data-zoom="10"] .map-text-marker { transform: translate(-50%, -100%) scale(0.4); opacity: 0.8;}
#map[data-zoom="11"] .map-text-marker, #map[data-zoom="12"] .map-text-marker { transform: translate(-50%, -100%) scale(0.6); }
#map[data-zoom="13"] .map-text-marker, #map[data-zoom="14"] .map-text-marker { transform: translate(-50%, -100%) scale(0.8); }

/* Cluster Icon */
.custom-cluster-icon { background: rgba(16, 185, 129, 0.95); backdrop-filter: blur(4px); color: white; border: 2px solid white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.4); transition: transform 0.3s ease; }
#map[data-zoom="6"] .custom-cluster-icon, #map[data-zoom="7"] .custom-cluster-icon { transform: scale(0.5); }

@keyframes bounceSoft { 0%, 100% { transform: translateY(0); filter: drop-shadow(0 8px 6px rgba(0,0,0,0.6)); } 50% { transform: translateY(-8px); filter: drop-shadow(0 14px 8px rgba(0,0,0,0.4)); } }

.no-scrollbar::-webkit-scrollbar{display:none} .no-scrollbar{-ms-overflow-style:none;scrollbar-width:none}
.dropdown-anim { animation: slideDown 0.2s ease-out forwards; transform-origin: top center; }
@keyframes slideDown { from { opacity: 0; transform: scaleY(.9); } to { opacity: 1; transform: scaleY(1); } }

/* Digital Toast */
.toast { position: fixed; top: 2rem; left: 50%; transform: translateX(-50%); background: rgba(6, 78, 59, 0.95); backdrop-filter: blur(10px); border: 1px solid rgba(16, 185, 129, 0.5); color: #fff; font-size: 13px; font-weight: 700; padding: 1rem 1.5rem; border-radius: 9999px; box-shadow: 0 10px 25px rgba(0,0,0,0.3); z-index: 9999; white-space: nowrap; animation: toastDrop .4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
@keyframes toastDrop { from { top: -2rem; opacity: 0; } to { top: 2rem; opacity: 1; } }

input, textarea { color: #1f2937 !important; background: white !important; }
input::placeholder, textarea::placeholder { color: #9ca3af !important; }
</style>
</head>
<body class="text-gray-800">

<!-- Header & Timer -->
<header class="glass-header text-white shadow-lg sticky top-0 z-[1000]">
  <div class="p-4 w-full md:max-w-2xl mx-auto flex justify-between items-center">
    <h1 class="text-xl md:text-2xl font-extrabold flex items-center gap-2 tracking-tight cursor-pointer" onclick="window.location.reload()">
      <i class="fas fa-moon text-yellow-300"></i> Iftar Tracker BD
    </h1>
    <div id="headerDate" class="text-[10px] md:text-xs font-bold bg-white/20 px-3 py-1.5 rounded-full backdrop-blur-md border border-white/20 shadow-inner"></div>
  </div>
  
  <div id="iftarCountdownBar" class="hidden bg-yellow-400 text-emerald-900 text-xs md:text-sm font-extrabold text-center py-2 shadow-inner transition-all duration-500 tracking-wide border-b border-yellow-500"></div>
  
  <!-- üîç Ultimate Trilingual Search Section -->
  <div class="p-3 w-full md:max-w-2xl mx-auto space-y-2 relative">
    <div class="flex gap-2 relative">
      <div class="relative w-1/2" id="distContainer">
        <button type="button" onclick="toggleDD('distList')" class="w-full bg-white/20 backdrop-blur-md text-white text-xs md:text-sm p-3 rounded-xl border border-white/30 outline-none flex justify-between items-center shadow-inner hover:bg-white/30 transition-colors">
          <span id="distBtnText" class="truncate font-bold">‡¶ú‡ßá‡¶≤‡¶æ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶®</span>
          <i class="fas fa-chevron-down text-[10px]"></i>
        </button>
        <div id="distList" class="hidden absolute top-full left-0 mt-2 w-[240px] md:w-[300px] glass-panel rounded-2xl shadow-2xl z-[2000] overflow-hidden dropdown-anim border-2 border-emerald-200">
          <div class="p-2 border-b border-gray-200/50 bg-white/90 sticky top-0">
            <input type="text" id="distSearch" oninput="filterList('distSearch','distUl')" placeholder="üîç ‡¶ú‡ßá‡¶≤‡¶æ ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶® (Bangla/English)..." class="w-full text-xs md:text-sm p-2.5 border border-emerald-400 rounded-xl outline-none focus:ring-2 focus:ring-emerald-600 bg-white text-gray-900 font-medium shadow-inner">
          </div>
          <ul id="distUl" class="max-h-56 overflow-y-auto text-xs md:text-sm text-gray-800 font-bold bg-white/80"></ul>
        </div>
      </div>

      <div class="relative w-1/2" id="upzContainer">
        <button type="button" onclick="toggleDD('upzList')" id="upzBtn" class="w-full bg-white/20 backdrop-blur-md text-white text-xs md:text-sm p-3 rounded-xl border border-white/30 outline-none flex justify-between items-center shadow-inner opacity-50 cursor-not-allowed" disabled>
          <span id="upzBtnText" class="truncate font-bold">‡¶â‡¶™‡¶ú‡ßá‡¶≤‡¶æ</span>
          <i class="fas fa-chevron-down text-[10px]"></i>
        </button>
        <div id="upzList" class="hidden absolute top-full right-0 mt-2 w-[240px] md:w-[300px] glass-panel rounded-2xl shadow-2xl z-[2000] overflow-hidden dropdown-anim border-2 border-emerald-200">
          <div class="p-2 border-b border-gray-200/50 bg-white/90 sticky top-0">
            <input type="text" id="upzSearch" oninput="filterList('upzSearch','upzUl')" placeholder="üîç ‡¶â‡¶™‡¶ú‡ßá‡¶≤‡¶æ ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶® (Bangla/En)..." class="w-full text-xs md:text-sm p-2.5 border border-emerald-400 rounded-xl outline-none focus:ring-2 focus:ring-emerald-600 bg-white text-gray-900 font-medium shadow-inner">
          </div>
          <ul id="upzUl" class="max-h-56 overflow-y-auto text-xs md:text-sm text-gray-800 font-bold bg-white/80">
            <li class="p-3 text-center text-gray-500">‡¶Ü‡¶ó‡ßá ‡¶ú‡ßá‡¶≤‡¶æ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</li>
          </ul>
        </div>
      </div>
    </div>
    
    <div class="relative w-full">
      <input type="text" id="villageInput" oninput="debounceVillage()" placeholder="‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶¨‡¶æ ‡¶ó‡ßÅ‡¶ó‡¶≤ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶™ ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶™‡ßá‡¶∏‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®..." class="w-full bg-white/20 backdrop-blur-md text-white text-xs md:text-sm font-bold p-3.5 rounded-xl border border-white/40 outline-none shadow-inner focus:bg-white/30 transition-colors placeholder-white/70">
      <ul id="villageSugg" class="hidden absolute top-full left-0 w-full mt-2 glass-panel rounded-2xl shadow-2xl z-[2000] overflow-hidden max-h-56 overflow-y-auto dropdown-anim border border-emerald-200 bg-white/90"></ul>
    </div>
  </div>
</header>

<!-- üïå Nearby Mosque Suggestions -->
<div id="nearbyContainer" class="hidden bg-emerald-50/90 backdrop-blur-md border-b border-emerald-200 p-2 overflow-x-auto whitespace-nowrap no-scrollbar w-full md:max-w-2xl mx-auto shadow-sm">
   <div class="text-[11px] md:text-xs font-extrabold text-emerald-800 mb-1.5 flex items-center gap-1"><i class="fas fa-mosque"></i> ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶∂‡ßá‡¶™‡¶æ‡¶∂‡ßá‡¶∞ ‡¶Æ‡¶∏‡¶ú‡¶ø‡¶¶ (‡ßß ‡¶ï‡¶ø.‡¶Æ‡¶ø)</div>
   <div id="nearbyList" class="flex gap-2"></div>
</div>

<main class="w-full md:max-w-2xl mx-auto relative px-2 md:px-4">
  
  <!-- üó∫Ô∏è Map Section -->
  <div class="mt-4 relative">
      <section class="relative w-full h-[55vh] md:h-[65vh] bg-gray-200 z-0 border-[6px] border-white/80 rounded-[2rem] shadow-[0_15px_30px_rgba(0,0,0,0.2)] overflow-hidden box-border">
        
        <!-- üî• Location Overlay (Auto hides when located) -->
        <div id="locationOverlay" class="absolute top-3 left-1/2 transform -translate-x-1/2 z-[400] glass-panel px-5 py-2.5 rounded-full shadow-lg border border-white/50 flex flex-col items-center gap-1 w-[90%] md:w-[60%] justify-center transition-all duration-500">
          <div class="flex items-center gap-2">
            <i class="fas fa-satellite text-emerald-600 animate-pulse text-lg"></i>
            <p id="locationStatus" class="text-xs md:text-sm font-extrabold text-gray-800 text-center tracking-wide">‡¶Æ‡ßç‡¶Ø‡¶æ‡¶™ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>
          </div>
        </div>

        <!-- üî• Floating Live Route UI Over Map (With Navigation Details) -->
        <div id="routeInfoOverlay" class="hidden absolute top-16 left-1/2 transform -translate-x-1/2 z-[500] bg-white/95 backdrop-blur-md px-4 py-3 rounded-2xl shadow-2xl border-2 border-blue-400 w-[90%] md:w-[60%] flex justify-between items-center">
            <div id="routeInfoText" class="text-xs md:text-sm font-bold text-blue-900 flex flex-col gap-1 w-full"></div>
            <button onclick="cancelRoute()" class="bg-red-100 text-red-600 w-8 h-8 rounded-full shadow-md hover:bg-red-200 flex items-center justify-center flex-shrink-0 active:scale-90 transition-all ml-3"><i class="fas fa-times"></i></button>
        </div>

        <!-- üéØ Current Location Magic Button -->
        <button onclick="manualLocTrigger()" class="absolute bottom-5 right-4 z-[400] glass-panel text-blue-600 p-4 md:p-5 rounded-full shadow-xl border-2 border-white hover:bg-white/90 transition-all active:scale-90 flex items-center justify-center group bg-white/80">
          <i class="fas fa-crosshairs text-2xl md:text-3xl group-hover:animate-pulse"></i>
        </button>
        <div id="map" class="w-full h-full z-0"></div>
      </section>
  </div>

  <!-- üìù Hidden Form -->
  <section id="formSection" class="hidden absolute bottom-0 left-0 w-full glass-panel rounded-t-[2.5rem] p-6 md:p-8 shadow-[0_-20px_50px_rgba(0,0,0,0.2)] z-[500] border-t-2 border-white overflow-y-auto max-h-[85vh]">
    <div class="flex justify-between items-center mb-5">
      <h2 id="formTitle" class="text-xl font-extrabold text-emerald-900 flex items-center gap-2">
        <i class="fas fa-map-pin text-red-500"></i> ‡¶á‡¶´‡¶§‡¶æ‡¶∞ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®
      </h2>
      <button type="button" onclick="hideForm()" class="p-2.5 bg-white/60 rounded-full hover:bg-red-100 hover:text-red-600 transition-colors shadow-sm"><i class="fas fa-times text-lg"></i></button>
    </div>
    
    <form id="iftarForm" class="space-y-4">
      <input type="hidden" id="editMosqueId" value="">
      
      <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="block text-[11px] font-extrabold text-emerald-800 mb-1 uppercase tracking-wider">‡¶¶‡¶æ‡¶§‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ</label>
            <input type="text" id="providerName" required placeholder="‡¶â‡¶¶‡¶æ‡¶É ‡¶´‡¶∞‡¶ø‡¶¶" class="w-full p-3.5 bg-white/80 border border-white rounded-xl focus:ring-2 focus:ring-emerald-500 outline-none font-bold text-sm shadow-inner text-gray-900" style="text-transform: capitalize;"/>
          </div>
          <div>
            <label class="block text-[11px] font-extrabold text-emerald-800 mb-1 uppercase tracking-wider">‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞</label>
            <input type="tel" id="providerPhone" required placeholder="017XXXXXX" class="w-full p-3.5 bg-white/80 border border-white rounded-xl focus:ring-2 focus:ring-emerald-500 outline-none font-bold text-sm shadow-inner text-gray-900"/>
          </div>
      </div>

      <div>
        <label class="block text-[11px] font-extrabold text-emerald-800 mb-1 uppercase tracking-wider">‡¶∏‡ßç‡¶•‡¶æ‡¶® ‡¶¨‡¶æ ‡¶¨‡¶æ‡¶°‡¶º‡¶ø‡¶∞ ‡¶®‡¶æ‡¶Æ</label>
        <input type="text" id="mosqueName" required placeholder="‡¶Ø‡ßá‡¶Æ‡¶®: ‡¶´‡¶∞‡¶ø‡¶¶‡ßá‡¶∞ ‡¶¨‡¶æ‡¶°‡¶º‡¶ø / ‡¶¨‡¶°‡¶º ‡¶Æ‡¶∏‡¶ú‡¶ø‡¶¶" class="w-full p-3.5 bg-white/80 border border-white rounded-xl focus:ring-2 focus:ring-emerald-500 outline-none font-bold text-sm shadow-inner text-gray-900"/>
      </div>
      <div>
        <label class="block text-[11px] font-extrabold text-emerald-800 mb-1 uppercase tracking-wider">‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶á‡¶´‡¶§‡¶æ‡¶∞ ‡¶Æ‡ßá‡¶®‡ßç‡¶Ø‡ßÅ</label>
        <textarea id="iftarItems" required rows="3" placeholder="‡¶Ø‡ßá‡¶Æ‡¶®: ‡¶õ‡ßã‡¶≤‡¶æ, ‡¶Æ‡ßÅ‡¶°‡¶º‡¶ø, ‡¶ñ‡ßá‡¶ú‡ßÅ‡¶∞, ‡¶ú‡¶ø‡¶≤‡¶æ‡¶™‡¶ø..." class="w-full p-3.5 bg-white/80 border border-white rounded-xl focus:ring-2 focus:ring-emerald-500 outline-none resize-none font-bold text-sm shadow-inner text-gray-900"></textarea>
      </div>
      <div class="grid grid-cols-2 gap-3 md:gap-4">
        <label id="mosqueImageLabel" class="flex flex-col items-center justify-center p-4 border-2 border-dashed border-emerald-400 rounded-xl cursor-pointer hover:border-emerald-600 transition-colors bg-white/60 shadow-sm">
          <i id="mosqueImageIcon" class="fas fa-camera text-emerald-600 text-2xl mb-1.5"></i>
          <span class="text-[11px] font-extrabold text-emerald-900 text-center">‡¶∏‡ßç‡¶•‡¶æ‡¶® ‡¶õ‡¶¨‡¶ø <span class="text-red-500" id="mosqueImgReq">*</span></span>
          <input type="file" accept="image/*" class="hidden" onchange="handleImg(this,'mosque')">
        </label>
        <label id="foodImageLabel" class="flex flex-col items-center justify-center p-4 border-2 border-dashed border-gray-400 rounded-xl cursor-pointer hover:border-emerald-500 transition-colors bg-white/50 shadow-sm">
          <i id="foodImageIcon" class="fas fa-camera text-gray-500 text-2xl mb-1.5"></i>
          <span class="text-[11px] font-extrabold text-gray-700 text-center">‡¶á‡¶´‡¶§‡¶æ‡¶∞ ‡¶õ‡¶¨‡¶ø (‡¶ê‡¶ö‡ßç‡¶õ‡¶ø‡¶ï)</span>
          <input type="file" accept="image/*" class="hidden" onchange="handleImg(this,'food')">
        </label>
      </div>
      <button type="submit" id="submitBtn" class="w-full bg-gradient-to-r from-emerald-600 to-emerald-800 hover:from-emerald-700 hover:to-emerald-900 text-white font-extrabold py-4.5 rounded-xl shadow-[0_8px_20px_rgba(16,185,129,0.4)] transition-all active:scale-95 flex justify-center items-center gap-2 border border-emerald-400 text-lg mt-2">
        <span id="submitBtnText">‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶® üöÄ</span>
      </button>
    </form>
  </section>

  <!-- üëÄ View Modal (Glassmorphism) -->
  <div id="viewModal" class="hidden fixed inset-0 z-[2000] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4">
    <div class="glass-panel rounded-3xl w-full max-w-md max-h-[90vh] overflow-y-auto shadow-2xl relative animate-in zoom-in-95 border border-white/60">
      <button onclick="closeModal()" class="absolute top-3 right-3 p-2.5 bg-black/40 backdrop-blur-md text-white rounded-full hover:bg-red-500 transition-colors z-10 shadow-sm"><i class="fas fa-times text-lg"></i></button>
      
      <div class="relative h-56 bg-gray-200 flex items-center justify-center overflow-hidden rounded-t-3xl">
        <div id="mosqueImgLoader" class="absolute inset-0 flex flex-col items-center justify-center bg-gray-100 z-10">
          <i class="fas fa-spinner fa-spin text-emerald-500 text-4xl"></i>
        </div>
        <img id="viewMosqueImg" src="" class="w-full h-full object-cover hidden">
      </div>
      
      <div class="p-6">
        <h2 id="viewMosqueName" class="text-2xl font-extrabold text-emerald-950 mb-1 leading-tight"></h2>
        <p class="text-sm text-gray-700 mb-5 flex items-start gap-1.5 font-medium"><i class="fas fa-map-marker-alt mt-1 text-emerald-600"></i> <span id="viewAddress"></span></p>

        <div class="bg-white/80 p-5 rounded-2xl border border-white mb-5 shadow-md">
          <p class="text-xs font-extrabold text-emerald-600 mb-3 uppercase tracking-wide border-b border-emerald-100 pb-1.5">‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶Æ‡ßá‡¶®‡ßç‡¶Ø‡ßÅ ‡¶ì ‡¶¶‡¶æ‡¶§‡¶æ</p>
          <p id="viewItems" class="text-gray-900 font-bold text-base whitespace-pre-wrap leading-relaxed"></p>
        </div>
        
        <div id="foodImgSection" class="hidden mb-5">
          <p class="text-xs font-extrabold text-gray-500 mb-2.5 uppercase tracking-wide">‡¶á‡¶´‡¶§‡¶æ‡¶∞‡ßá‡¶∞ ‡¶õ‡¶¨‡¶ø</p>
          <div class="relative h-40 bg-gray-100 rounded-2xl overflow-hidden border border-gray-200 shadow-inner">
             <div id="foodImgLoader" class="absolute inset-0 flex flex-col items-center justify-center z-10 bg-gray-50"><i class="fas fa-spinner fa-spin text-emerald-500 text-2xl"></i></div>
             <img id="viewFoodImg" src="" class="w-full h-full object-cover hidden hover:scale-105 transition-transform duration-500">
          </div>
        </div>
        
        <div class="flex gap-2.5 text-sm">
          <button onclick="startRouting()" class="flex-1 bg-gradient-to-r from-blue-500 to-blue-700 text-white font-extrabold py-3.5 rounded-xl shadow-[0_4px_10px_rgba(59,130,246,0.4)] transition-all active:scale-95 flex items-center justify-center gap-1.5"><i class="fas fa-walking"></i> ‡¶π‡¶æ‡¶Å‡¶ü‡¶æ‡¶∞ ‡¶∞‡ßÅ‡¶ü</button>
          <button onclick="openEdit()" class="flex-1 bg-gradient-to-r from-yellow-400 to-yellow-500 text-emerald-950 font-extrabold py-3.5 rounded-xl shadow-[0_4px_10px_rgba(234,179,8,0.4)] transition-all active:scale-95 flex items-center justify-center gap-1.5"><i class="fas fa-edit"></i> ‡¶è‡¶°‡¶ø‡¶ü</button>
          <button onclick="doShare()" class="flex-1 bg-gradient-to-r from-emerald-500 to-emerald-700 text-white font-extrabold py-3.5 rounded-xl shadow-[0_4px_10px_rgba(16,185,129,0.4)] transition-all active:scale-95 flex items-center justify-center gap-1.5"><i class="fas fa-share-alt"></i> ‡¶∂‡ßá‡¶Ø‡¶º‡¶æ‡¶∞</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Live Feed Section -->
  <section class="mt-8 mb-10 px-2">
    <h2 class="text-xl font-extrabold text-gray-800 mb-5 flex items-center gap-2 px-1">
      <span class="relative flex h-4 w-4"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span><span class="relative inline-flex rounded-full h-4 w-4 bg-emerald-500"></span></span>
      ‡¶ï‡¶æ‡¶õ‡¶æ‡¶ï‡¶æ‡¶õ‡¶ø ‡¶≤‡¶æ‡¶á‡¶≠ ‡¶á‡¶´‡¶§‡¶æ‡¶∞ üì° 
      <span id="feedLocationFilter" class="text-xs font-bold text-emerald-800 ml-auto bg-emerald-200 px-3 py-1.5 rounded-full border border-emerald-300 shadow-sm hidden"></span>
    </h2>
    <div id="feedContainer" class="space-y-4"></div>
  </section>

  <!-- üî• FA Rid Credit Footer -->
  <footer class="mt-6 text-center pb-8">
      <p class="text-sm text-gray-600 font-bold">Developed with <span class="text-red-500 animate-pulse inline-block text-lg">‚ù§Ô∏è</span> by <a href="https://t.me/mftiforchannel" target="_blank" class="text-emerald-700 font-extrabold hover:underline">FA Rid</a></p>
      <p class="text-xs text-gray-400 mt-1 font-medium">FF6V+G3 Baghchapa, Godagari, Rajshahi</p>
  </footer>
</main>

<script>
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   üîê GLOBAL STEALTH KEYS & STATE
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const __V__ = (function(){
  const _sU = atob('aHR0cHM6Ly91cGZjb2Ztc3dzbmNyd2l6ZXl3dy5zdXBhYmFzZS5jbw=='); 
  const _sK = atob('c2JfcHVibGlzaGFibGVfZ0N3LXc4aEphMHlxbV94WmsyV3dOZ19MVmsxWjR6TA=='); 
  const _tT = atob('ODQ0NjE5MDE3OTpBQUdOWU52STdQVm9ZdUd5anU4Qm9SYjdtQ2ttZG5Lck9oSQ=='); 
  const _tC = atob('LTEwMDMyNzA5NzQwOTI='); 
  return { u: () => _sU, t: () => _tT, c: () => _tC, h: () => ({'apikey': _sK, 'Authorization': `Bearer ${_sK}`, 'Content-Type': 'application/json', 'Prefer': 'return=representation'}) };
})();

// üî• Global Variables Correctly Declared ONCE
let map, markersGroup, clickMark, trackId, routeLine = null;
let uLoc = {lat: 24.4696, lng: 88.3314}, isLocationVerified = false, mapMovedByUser = false, initialLocationSet = false;
let selMapLoc = null, mosqBlob = null, foodBlob = null, feed = [], viewPost = null, cdInterval = null, userMarker = null;
let activeRouteTarget = null, isRouteFirstDraw = true;
let curAddr = "‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂", curDistStr = "", curUpzStr = ""; 
let selDist = "", selUpz = "";
let currentMaghribDate = null; 

const bnDigits = ['‡ß¶','‡ßß','‡ß®','‡ß©','‡ß™','‡ß´','‡ß¨','‡ß≠','‡ßÆ','‡ßØ'];

// üî• Real-Time Client
const { createClient } = supabase;
const _client = createClient(__V__.u(), atob('c2JfcHVibGlzaGFibGVfZ0N3LXc4aEphMHlxbV94WmsyV3dOZ19MVmsxWjR6TA=='));

// üî• ‡ß¨‡ß™ ‡¶ú‡ßá‡¶≤‡¶æ ‡¶ì ‡¶â‡¶™‡¶ú‡ßá‡¶≤‡¶æ‡¶∞ ‡¶´‡ßÅ‡¶≤ ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶∏
const GEO = {
  "‡¶¢‡¶æ‡¶ï‡¶æ | Dhaka": ["‡¶¢‡¶æ‡¶ï‡¶æ ‡¶∏‡¶¶‡¶∞ | Dhaka Sadar", "‡¶∏‡¶æ‡¶≠‡¶æ‡¶∞ | Savar", "‡¶ß‡¶æ‡¶Æ‡¶∞‡¶æ‡¶á | Dhamrai", "‡¶ï‡ßá‡¶∞‡¶æ‡¶®‡ßÄ‡¶ó‡¶û‡ßç‡¶ú | Keraniganj", "‡¶®‡¶¨‡¶æ‡¶¨‡¶ó‡¶û‡ßç‡¶ú | Nawabganj", "‡¶¶‡ßã‡¶π‡¶æ‡¶∞ | Dohar"],
  "‡¶ó‡¶æ‡¶ú‡ßÄ‡¶™‡ßÅ‡¶∞ | Gazipur": ["‡¶ó‡¶æ‡¶ú‡ßÄ‡¶™‡ßÅ‡¶∞ ‡¶∏‡¶¶‡¶∞ | Gazipur Sadar", "‡¶ï‡¶æ‡¶≤‡¶ø‡¶Ø‡¶º‡¶æ‡¶ï‡ßà‡¶∞ | Kaliakair", "‡¶ï‡¶æ‡¶≤‡ßÄ‡¶ó‡¶û‡ßç‡¶ú | Kaliganj", "‡¶ï‡¶æ‡¶™‡¶æ‡¶∏‡¶ø‡¶Ø‡¶º‡¶æ | Kapasia", "‡¶∂‡ßç‡¶∞‡ßÄ‡¶™‡ßÅ‡¶∞ | Sreepur"],
  "‡¶®‡¶æ‡¶∞‡¶æ‡¶Ø‡¶º‡¶£‡¶ó‡¶û‡ßç‡¶ú | Narayanganj": ["‡¶®‡¶æ‡¶∞‡¶æ‡¶Ø‡¶º‡¶£‡¶ó‡¶û‡ßç‡¶ú ‡¶∏‡¶¶‡¶∞ | Narayanganj Sadar", "‡¶¨‡¶®‡ßç‡¶¶‡¶∞ | Bandar", "‡¶Ü‡¶°‡¶º‡¶æ‡¶á‡¶π‡¶æ‡¶ú‡¶æ‡¶∞ | Araihazar", "‡¶∞‡ßÇ‡¶™‡¶ó‡¶û‡ßç‡¶ú | Rupganj", "‡¶∏‡ßã‡¶®‡¶æ‡¶∞‡¶ó‡¶æ‡¶Å‡¶ì | Sonargaon"],
  "‡¶Æ‡ßÅ‡¶®‡ßç‡¶∏‡ßÄ‡¶ó‡¶û‡ßç‡¶ú | Munshiganj": ["‡¶Æ‡ßÅ‡¶®‡ßç‡¶∏‡ßÄ‡¶ó‡¶û‡ßç‡¶ú ‡¶∏‡¶¶‡¶∞ | Munshiganj Sadar", "‡¶ü‡¶Ç‡¶ó‡ßÄ‡¶¨‡¶æ‡¶°‡¶º‡ßÄ | Tongibari", "‡¶∏‡¶ø‡¶∞‡¶æ‡¶ú‡¶¶‡ßÄ‡¶ñ‡¶æ‡¶® | Sirajdikhan", "‡¶≤‡ßå‡¶π‡¶ú‡¶Ç | Louhajang", "‡¶∂‡ßç‡¶∞‡ßÄ‡¶®‡¶ó‡¶∞ | Srinagar", "‡¶ó‡¶ú‡¶æ‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ | Gazaria"],
  "‡¶Æ‡¶æ‡¶®‡¶ø‡¶ï‡¶ó‡¶û‡ßç‡¶ú | Manikganj": ["‡¶Æ‡¶æ‡¶®‡¶ø‡¶ï‡¶ó‡¶û‡ßç‡¶ú ‡¶∏‡¶¶‡¶∞ | Manikganj Sadar", "‡¶∏‡¶ø‡¶ô‡ßç‡¶ó‡¶æ‡¶á‡¶∞ | Singair", "‡¶∏‡¶æ‡¶ü‡ßÅ‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ | Saturia", "‡¶ò‡¶ø‡¶ì‡¶∞ | Ghior", "‡¶∂‡¶ø‡¶¨‡¶æ‡¶≤‡¶Ø‡¶º | Shibalaya", "‡¶π‡¶∞‡¶ø‡¶∞‡¶æ‡¶Æ‡¶™‡ßÅ‡¶∞ | Harirampur", "‡¶¶‡ßå‡¶≤‡¶§‡¶™‡ßÅ‡¶∞ | Daulatpur"],
  "‡¶®‡¶∞‡¶∏‡¶ø‡¶Ç‡¶¶‡ßÄ | Narsingdi": ["‡¶®‡¶∞‡¶∏‡¶ø‡¶Ç‡¶¶‡ßÄ ‡¶∏‡¶¶‡¶∞ | Narsingdi Sadar", "‡¶™‡¶≤‡¶æ‡¶∂ | Palash", "‡¶∂‡¶ø‡¶¨‡¶™‡ßÅ‡¶∞ | Shibpur", "‡¶Æ‡¶®‡ßã‡¶π‡¶∞‡¶¶‡ßÄ | Monohardi", "‡¶¨‡ßá‡¶≤‡¶æ‡¶¨‡ßã | Belabo", "‡¶∞‡¶æ‡¶Ø‡¶º‡¶™‡ßÅ‡¶∞‡¶æ | Raipura"],
  "‡¶´‡¶∞‡¶ø‡¶¶‡¶™‡ßÅ‡¶∞ | Faridpur": ["‡¶´‡¶∞‡¶ø‡¶¶‡¶™‡ßÅ‡¶∞ ‡¶∏‡¶¶‡¶∞ | Faridpur Sadar", "‡¶¨‡ßã‡¶Ø‡¶º‡¶æ‡¶≤‡¶Æ‡¶æ‡¶∞‡ßÄ | Boalmari", "‡¶Ü‡¶≤‡¶´‡¶æ‡¶°‡¶æ‡¶ô‡ßç‡¶ó‡¶æ | Alfadanga", "‡¶Æ‡¶ß‡ßÅ‡¶ñ‡¶æ‡¶≤‡ßÄ | Madhukhali", "‡¶≠‡¶æ‡¶ô‡ßç‡¶ó‡¶æ | Bhanga", "‡¶®‡¶ó‡¶∞‡¶ï‡¶æ‡¶®‡ßç‡¶¶‡¶æ | Nagarkanda", "‡¶ö‡¶∞‡¶≠‡¶¶‡ßç‡¶∞‡¶æ‡¶∏‡¶® | Charbhadrasan", "‡¶∏‡¶¶‡¶∞‡¶™‡ßÅ‡¶∞ | Sadarpur", "‡¶∂‡¶æ‡¶≤‡¶•‡¶æ | Saltha"],
  "‡¶Æ‡¶æ‡¶¶‡¶æ‡¶∞‡ßÄ‡¶™‡ßÅ‡¶∞ | Madaripur": ["‡¶Æ‡¶æ‡¶¶‡¶æ‡¶∞‡ßÄ‡¶™‡ßÅ‡¶∞ ‡¶∏‡¶¶‡¶∞ | Madaripur Sadar", "‡¶∂‡¶ø‡¶¨‡¶ö‡¶∞ | Shibchar", "‡¶ï‡¶æ‡¶≤‡¶ï‡¶ø‡¶®‡¶ø | Kalkini", "‡¶∞‡¶æ‡¶ú‡ßà‡¶∞ | Rajoir"],
  "‡¶∂‡¶∞‡ßÄ‡¶Ø‡¶º‡¶§‡¶™‡ßÅ‡¶∞ | Shariatpur": ["‡¶∂‡¶∞‡ßÄ‡¶Ø‡¶º‡¶§‡¶™‡ßÅ‡¶∞ ‡¶∏‡¶¶‡¶∞ | Shariatpur Sadar", "‡¶ú‡¶æ‡¶ú‡¶ø‡¶∞‡¶æ | Zajira", "‡¶®‡¶°‡¶º‡¶ø‡¶Ø‡¶º‡¶æ | Naria", "‡¶≠‡ßá‡¶¶‡¶∞‡¶ó‡¶û‡ßç‡¶ú | Bhedarganj", "‡¶°‡¶æ‡¶Æ‡ßÅ‡¶°‡ßç‡¶Ø‡¶æ | Damudya", "‡¶ó‡ßã‡¶∏‡¶æ‡¶á‡¶∞‡¶π‡¶æ‡¶ü | Gosairhat"],
  "‡¶ó‡ßã‡¶™‡¶æ‡¶≤‡¶ó‡¶û‡ßç‡¶ú | Gopalganj": ["‡¶ó‡ßã‡¶™‡¶æ‡¶≤‡¶ó‡¶û‡ßç‡¶ú ‡¶∏‡¶¶‡¶∞ | Gopalganj Sadar", "‡¶ï‡¶æ‡¶∂‡¶ø‡¶Ø‡¶º‡¶æ‡¶®‡ßÄ | Kashiani", "‡¶Æ‡ßÅ‡¶ï‡¶∏‡ßÅ‡¶¶‡¶™‡ßÅ‡¶∞ | Muksudpur", "‡¶ï‡ßã‡¶ü‡¶æ‡¶≤‡ßÄ‡¶™‡¶æ‡¶°‡¶º‡¶æ | Kotalipara", "‡¶ü‡ßÅ‡¶ô‡ßç‡¶ó‡¶ø‡¶™‡¶æ‡¶°‡¶º‡¶æ | Tungipara"],
  "‡¶∞‡¶æ‡¶ú‡¶¨‡¶æ‡¶°‡¶º‡ßÄ | Rajbari": ["‡¶∞‡¶æ‡¶ú‡¶¨‡¶æ‡¶°‡¶º‡ßÄ ‡¶∏‡¶¶‡¶∞ | Rajbari Sadar", "‡¶ó‡ßã‡¶Ø‡¶º‡¶æ‡¶≤‡¶®‡ßç‡¶¶ | Goalanda", "‡¶™‡¶æ‡¶Ç‡¶∂‡¶æ | Pangsha", "‡¶¨‡¶æ‡¶≤‡¶ø‡¶Ø‡¶º‡¶æ‡¶ï‡¶æ‡¶®‡ßç‡¶¶‡¶ø | Baliakandi", "‡¶ï‡¶æ‡¶≤‡ßÅ‡¶ñ‡¶æ‡¶≤‡ßÄ | Kalukhali"],
  "‡¶ï‡¶ø‡¶∂‡ßã‡¶∞‡¶ó‡¶û‡ßç‡¶ú | Kishoreganj": ["‡¶ï‡¶ø‡¶∂‡ßã‡¶∞‡¶ó‡¶û‡ßç‡¶ú ‡¶∏‡¶¶‡¶∞ | Kishoreganj Sadar", "‡¶π‡ßã‡¶∏‡ßá‡¶®‡¶™‡ßÅ‡¶∞ | Hossainpur", "‡¶™‡¶æ‡¶ï‡ßÅ‡¶®‡ßç‡¶¶‡¶ø‡¶Ø‡¶º‡¶æ | Pakundia", "‡¶ï‡¶ü‡¶ø‡¶Ø‡¶º‡¶æ‡¶¶‡ßÄ | Katiadi", "‡¶≠‡ßà‡¶∞‡¶¨ | Bhairab", "‡¶ï‡ßÅ‡¶≤‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞‡¶ö‡¶∞ | Kuliarchar", "‡¶¨‡¶æ‡¶ú‡¶ø‡¶§‡¶™‡ßÅ‡¶∞ | Bajitpur", "‡¶Ö‡¶∑‡ßç‡¶ü‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ | Austagram", "‡¶Æ‡¶ø‡¶†‡¶æ‡¶Æ‡¶á‡¶® | Mithamain", "‡¶á‡¶ü‡¶®‡¶æ | Itna", "‡¶§‡¶æ‡¶°‡¶º‡¶æ‡¶á‡¶≤ | Tarail", "‡¶ï‡¶∞‡¶ø‡¶Æ‡¶ó‡¶û‡ßç‡¶ú | Karimganj", "‡¶®‡¶ø‡¶ï‡¶≤‡ßÄ | Nikli"],
  "‡¶Æ‡¶Ø‡¶º‡¶Æ‡¶®‡¶∏‡¶ø‡¶Ç‡¶π | Mymensingh": ["‡¶Æ‡¶Ø‡¶º‡¶Æ‡¶®‡¶∏‡¶ø‡¶Ç‡¶π ‡¶∏‡¶¶‡¶∞ | Mymensingh Sadar", "‡¶Æ‡ßÅ‡¶ï‡ßç‡¶§‡¶æ‡¶ó‡¶æ‡¶õ‡¶æ | Muktagacha", "‡¶´‡ßÅ‡¶≤‡¶¨‡¶æ‡¶°‡¶º‡¶ø‡¶Ø‡¶º‡¶æ | Fulbaria", "‡¶§‡ßç‡¶∞‡¶ø‡¶∂‡¶æ‡¶≤ | Trishal", "‡¶≠‡¶æ‡¶≤‡ßÅ‡¶ï‡¶æ | Bhaluka", "‡¶ó‡¶´‡¶∞‡¶ó‡¶æ‡¶Å‡¶ì | Gafargaon", "‡¶®‡¶æ‡¶®‡ßç‡¶¶‡¶æ‡¶á‡¶≤ | Nandail", "‡¶à‡¶∂‡ßç‡¶¨‡¶∞‡¶ó‡¶û‡ßç‡¶ú | Ishwarganj", "‡¶ó‡ßå‡¶∞‡ßÄ‡¶™‡ßÅ‡¶∞ | Gouripur", "‡¶´‡ßÅ‡¶≤‡¶™‡ßÅ‡¶∞ | Phulpur", "‡¶§‡¶æ‡¶∞‡¶æ‡¶ï‡¶æ‡¶®‡ßç‡¶¶‡¶æ | Tarakanda", "‡¶π‡¶æ‡¶≤‡ßÅ‡¶Ø‡¶º‡¶æ‡¶ò‡¶æ‡¶ü | Haluaghat", "‡¶ß‡ßã‡¶¨‡¶æ‡¶â‡¶°‡¶º‡¶æ | Dhobaura"],
  "‡¶ú‡¶æ‡¶Æ‡¶æ‡¶≤‡¶™‡ßÅ‡¶∞ | Jamalpur": ["‡¶ú‡¶æ‡¶Æ‡¶æ‡¶≤‡¶™‡ßÅ‡¶∞ ‡¶∏‡¶¶‡¶∞ | Jamalpur Sadar", "‡¶Æ‡ßá‡¶≤‡¶æ‡¶®‡ßç‡¶¶‡¶π | Melandah", "‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡¶™‡ßÅ‡¶∞ | Islampur", "‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ‡¶®‡¶ó‡¶û‡ßç‡¶ú | Dewanganj", "‡¶¨‡¶ï‡¶∂‡ßÄ‡¶ó‡¶û‡ßç‡¶ú | Bakshiganj", "‡¶Æ‡¶æ‡¶¶‡¶æ‡¶∞‡¶ó‡¶û‡ßç‡¶ú | Madarganj", "‡¶∏‡¶∞‡¶ø‡¶∑‡¶æ‡¶¨‡¶æ‡¶°‡¶º‡ßÄ | Sarishabari"],
  "‡¶®‡ßá‡¶§‡ßç‡¶∞‡¶ï‡ßã‡¶£‡¶æ | Netrokona": ["‡¶®‡ßá‡¶§‡ßç‡¶∞‡¶ï‡ßã‡¶£‡¶æ ‡¶∏‡¶¶‡¶∞ | Netrokona Sadar", "‡¶¨‡¶æ‡¶∞‡¶π‡¶æ‡¶ü‡ßç‡¶ü‡¶æ | Barhatta", "‡¶ï‡¶≤‡¶Æ‡¶æ‡¶ï‡¶æ‡¶®‡ßç‡¶¶‡¶æ | Kalmakanda", "‡¶¶‡ßÅ‡¶∞‡ßç‡¶ó‡¶æ‡¶™‡ßÅ‡¶∞ | Durgapur", "‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶ß‡¶≤‡¶æ | Purbadhala", "‡¶Æ‡ßã‡¶π‡¶®‡¶ó‡¶û‡ßç‡¶ú | Mohanganj", "‡¶Æ‡¶¶‡¶® | Madan", "‡¶ñ‡¶æ‡¶≤‡¶ø‡¶Ø‡¶º‡¶æ‡¶ú‡ßÅ‡¶∞‡ßÄ | Khaliajuri", "‡¶Ü‡¶ü‡¶™‡¶æ‡¶°‡¶º‡¶æ | Atpara", "‡¶ï‡ßá‡¶®‡ßç‡¶¶‡ßÅ‡¶Ø‡¶º‡¶æ | Kendua"],
  "‡¶∂‡ßá‡¶∞‡¶™‡ßÅ‡¶∞ | Sherpur": ["‡¶∂‡ßá‡¶∞‡¶™‡ßÅ‡¶∞ ‡¶∏‡¶¶‡¶∞ | Sherpur Sadar", "‡¶®‡¶ï‡¶≤‡¶æ | Nakla", "‡¶∂‡ßç‡¶∞‡ßÄ‡¶¨‡¶∞‡¶¶‡ßÄ | Sreebardi", "‡¶ù‡¶ø‡¶®‡¶æ‡¶á‡¶ó‡¶æ‡¶§‡ßÄ | Jhenaigati", "‡¶®‡¶æ‡¶≤‡¶ø‡¶§‡¶æ‡¶¨‡¶æ‡¶°‡¶º‡ßÄ | Nalitabari"],
  "‡¶ü‡¶æ‡¶ô‡ßç‡¶ó‡¶æ‡¶á‡¶≤ | Tangail": ["‡¶ü‡¶æ‡¶ô‡ßç‡¶ó‡¶æ‡¶á‡¶≤ ‡¶∏‡¶¶‡¶∞ | Tangail Sadar", "‡¶¨‡¶æ‡¶∏‡¶æ‡¶á‡¶≤ | Basail", "‡¶∏‡¶ñ‡¶ø‡¶™‡ßÅ‡¶∞ | Sakhipur", "‡¶Æ‡¶ø‡¶∞‡ßç‡¶ú‡¶æ‡¶™‡ßÅ‡¶∞ | Mirzapur", "‡¶¶‡ßá‡¶≤‡¶¶‡ßÅ‡¶Ø‡¶º‡¶æ‡¶∞ | Delduar", "‡¶®‡¶æ‡¶ó‡¶∞‡¶™‡ßÅ‡¶∞ | Nagarpur", "‡¶ï‡¶æ‡¶≤‡¶ø‡¶π‡¶æ‡¶§‡ßÄ | Kalihati", "‡¶ò‡¶æ‡¶ü‡¶æ‡¶á‡¶≤ | Ghatail", "‡¶Æ‡¶ß‡ßÅ‡¶™‡ßÅ‡¶∞ | Madhupur", "‡¶ß‡¶®‡¶¨‡¶æ‡¶°‡¶º‡ßÄ | Dhanbari", "‡¶ó‡ßã‡¶™‡¶æ‡¶≤‡¶™‡ßÅ‡¶∞ | Gopalpur", "‡¶≠‡ßÇ‡¶û‡¶æ‡¶™‡ßÅ‡¶∞ | Bhuapur"],
  "‡¶ö‡¶ü‡ßç‡¶ü‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ | Chattogram Chittagong": ["‡¶ö‡¶ü‡ßç‡¶ü‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶∏‡¶¶‡¶∞ | Chattogram Sadar", "‡¶∏‡ßÄ‡¶§‡¶æ‡¶ï‡ßÅ‡¶®‡ßç‡¶° | Sitakunda", "‡¶Æ‡¶ø‡¶∞‡¶∏‡¶∞‡¶æ‡¶á | Mirsharai", "‡¶´‡¶ü‡¶ø‡¶ï‡¶õ‡¶°‡¶º‡¶ø | Fatikchhari", "‡¶π‡¶æ‡¶ü‡¶π‡¶æ‡¶ú‡¶æ‡¶∞‡ßÄ | Hathazari", "‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶® | Raozan", "‡¶∞‡¶æ‡¶ô‡ßç‡¶ó‡ßÅ‡¶®‡¶ø‡¶Ø‡¶º‡¶æ | Rangunia", "‡¶¨‡ßã‡¶Ø‡¶º‡¶æ‡¶≤‡¶ñ‡¶æ‡¶≤‡ßÄ | Boalkhali", "‡¶™‡¶ü‡¶ø‡¶Ø‡¶º‡¶æ | Patiya", "‡¶Ü‡¶®‡ßã‡¶Ø‡¶º‡¶æ‡¶∞‡¶æ | Anwara", "‡¶ö‡¶®‡ßç‡¶¶‡¶®‡¶æ‡¶á‡¶∂ | Chandanaish", "‡¶∏‡¶æ‡¶§‡¶ï‡¶æ‡¶®‡¶ø‡¶Ø‡¶º‡¶æ | Satkania", "‡¶≤‡ßã‡¶π‡¶æ‡¶ó‡¶æ‡¶°‡¶º‡¶æ | Lohagara", "‡¶¨‡¶æ‡¶Å‡¶∂‡¶ñ‡¶æ‡¶≤‡ßÄ | Banshkhali", "‡¶∏‡¶®‡ßç‡¶¶‡ßç‡¶¨‡ßÄ‡¶™ | Sandwip", "‡¶ï‡¶∞‡ßç‡¶£‡¶´‡ßÅ‡¶≤‡ßÄ | Karnaphuli"],
  "‡¶ï‡¶ï‡ßç‡¶∏‡¶¨‡¶æ‡¶ú‡¶æ‡¶∞ | Cox's Bazar": ["‡¶ï‡¶ï‡ßç‡¶∏‡¶¨‡¶æ‡¶ú‡¶æ‡¶∞ ‡¶∏‡¶¶‡¶∞ | Cox's Bazar Sadar", "‡¶∞‡¶æ‡¶Æ‡ßÅ | Ramu", "‡¶â‡¶ñ‡¶ø‡¶Ø‡¶º‡¶æ | Ukhiya", "‡¶ü‡ßá‡¶ï‡¶®‡¶æ‡¶´ | Teknaf", "‡¶ö‡¶ï‡ßã‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ | Chakaria", "‡¶™‡ßá‡¶ï‡ßÅ‡¶Ø‡¶º‡¶æ | Pekua", "‡¶ï‡ßÅ‡¶§‡ßÅ‡¶¨‡¶¶‡¶ø‡¶Ø‡¶º‡¶æ | Kutubdia", "‡¶Æ‡¶π‡ßá‡¶∂‡¶ñ‡¶æ‡¶≤‡ßÄ | Moheshkhali"],
  "‡¶ï‡ßÅ‡¶Æ‡¶ø‡¶≤‡ßç‡¶≤‡¶æ | Cumilla Comilla": ["‡¶ï‡ßÅ‡¶Æ‡¶ø‡¶≤‡ßç‡¶≤‡¶æ ‡¶∏‡¶¶‡¶∞ | Cumilla Sadar", "‡¶ö‡ßå‡¶¶‡ßç‡¶¶‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ | Chauddagram", "‡¶≤‡¶æ‡¶ï‡¶∏‡¶æ‡¶Æ | Laksam", "‡¶¨‡¶∞‡ßÅ‡¶°‡¶º‡¶æ | Barura", "‡¶®‡¶æ‡¶ô‡ßç‡¶ó‡¶≤‡¶ï‡ßã‡¶ü | Nangalkot", "‡¶Æ‡¶®‡ßã‡¶π‡¶∞‡¶ó‡¶û‡ßç‡¶ú | Monoharganj", "‡¶¨‡ßÅ‡¶°‡¶º‡¶ø‡¶ö‡¶Ç | Burichang", "‡¶¨‡ßç‡¶∞‡¶æ‡¶π‡ßç‡¶Æ‡¶£‡¶™‡¶æ‡¶°‡¶º‡¶æ | Brahmanpara", "‡¶ö‡¶æ‡¶®‡ßç‡¶¶‡¶ø‡¶®‡¶æ | Chandina", "‡¶¶‡¶æ‡¶â‡¶¶‡¶ï‡¶æ‡¶®‡ßç‡¶¶‡¶ø | Daudkandi", "‡¶Æ‡ßá‡¶ò‡¶®‡¶æ | Meghna", "‡¶π‡ßã‡¶Æ‡¶®‡¶æ | Homna", "‡¶§‡¶ø‡¶§‡¶æ‡¶∏ | Titas", "‡¶Æ‡ßÅ‡¶∞‡¶æ‡¶¶‡¶®‡¶ó‡¶∞ | Muradnagar", "‡¶¶‡ßá‡¶¨‡¶ø‡¶¶‡ßç‡¶¨‡¶æ‡¶∞ | Debidwar", "‡¶∏‡¶¶‡¶∞ ‡¶¶‡¶ï‡ßç‡¶∑‡¶ø‡¶£ | Sadar South", "‡¶≤‡¶æ‡¶≤‡¶Æ‡¶æ‡¶á | Lalmai"],
  "‡¶¨‡ßç‡¶∞‡¶æ‡¶π‡ßç‡¶Æ‡¶£‡¶¨‡¶æ‡¶°‡¶º‡¶ø‡¶Ø‡¶º‡¶æ | Brahmanbaria": ["‡¶¨‡ßç‡¶∞‡¶æ‡¶π‡ßç‡¶Æ‡¶£‡¶¨‡¶æ‡¶°‡¶º‡¶ø‡¶Ø‡¶º‡¶æ ‡¶∏‡¶¶‡¶∞ | Brahmanbaria Sadar", "‡¶Ü‡¶∂‡ßÅ‡¶ó‡¶û‡ßç‡¶ú | Ashuganj", "‡¶∏‡¶∞‡¶æ‡¶á‡¶≤ | Sarail", "‡¶®‡¶æ‡¶∏‡¶ø‡¶∞‡¶®‡¶ó‡¶∞ | Nasirnagar", "‡¶®‡¶¨‡ßÄ‡¶®‡¶ó‡¶∞ | Nabinagar", "‡¶¨‡¶æ‡¶û‡ßç‡¶õ‡¶æ‡¶∞‡¶æ‡¶Æ‡¶™‡ßÅ‡¶∞ | Bancharampur", "‡¶ï‡¶∏‡¶¨‡¶æ | Kasba", "‡¶Ü‡¶ñ‡¶æ‡¶â‡¶°‡¶º‡¶æ | Akhaura", "‡¶¨‡¶ø‡¶ú‡¶Ø‡¶º‡¶®‡¶ó‡¶∞ | Bijoynagar"],
  "‡¶ö‡¶æ‡¶Å‡¶¶‡¶™‡ßÅ‡¶∞ | Chandpur": ["‡¶ö‡¶æ‡¶Å‡¶¶‡¶™‡ßÅ‡¶∞ ‡¶∏‡¶¶‡¶∞ | Chandpur Sadar", "‡¶´‡¶∞‡¶ø‡¶¶‡¶ó‡¶û‡ßç‡¶ú | Faridganj", "‡¶Æ‡¶§‡¶≤‡¶¨ ‡¶â‡¶§‡ßç‡¶§‡¶∞ | Matlab North", "‡¶Æ‡¶§‡¶≤‡¶¨ ‡¶¶‡¶ï‡ßç‡¶∑‡¶ø‡¶£ | Matlab South", "‡¶π‡¶æ‡¶ú‡ßÄ‡¶ó‡¶û‡ßç‡¶ú | Hajiganj", "‡¶∂‡¶æ‡¶π‡¶∞‡¶æ‡¶∏‡ßç‡¶§‡¶ø | Shahrasti", "‡¶ï‡¶ö‡ßÅ‡¶Ø‡¶º‡¶æ | Kachua", "‡¶π‡¶æ‡¶á‡¶Æ‡¶ö‡¶∞ | Haimchar"],
  "‡¶®‡ßã‡¶Ø‡¶º‡¶æ‡¶ñ‡¶æ‡¶≤‡ßÄ | Noakhali": ["‡¶®‡ßã‡¶Ø‡¶º‡¶æ‡¶ñ‡¶æ‡¶≤‡ßÄ ‡¶∏‡¶¶‡¶∞ | Noakhali Sadar", "‡¶¨‡ßá‡¶ó‡¶Æ‡¶ó‡¶û‡ßç‡¶ú | Begumganj", "‡¶∏‡ßã‡¶®‡¶æ‡¶á‡¶Æ‡ßÅ‡¶°‡¶º‡ßÄ | Sonaimuri", "‡¶ö‡¶æ‡¶ü‡¶ñ‡¶ø‡¶≤ | Chatkhil", "‡¶∏‡ßá‡¶®‡¶¨‡¶æ‡¶ó | Senbagh", "‡¶ï‡ßã‡¶Æ‡ßç‡¶™‡¶æ‡¶®‡ßÄ‡¶ó‡¶û‡ßç‡¶ú | Companiganj", "‡¶∏‡ßÅ‡¶¨‡¶∞‡ßç‡¶£‡¶ö‡¶∞ | Subarnachar", "‡¶π‡¶æ‡¶§‡¶ø‡¶Ø‡¶º‡¶æ | Hatiya", "‡¶ï‡¶¨‡¶ø‡¶∞‡¶π‡¶æ‡¶ü | Kabirhat"],
  "‡¶´‡ßá‡¶®‡ßÄ | Feni": ["‡¶´‡ßá‡¶®‡ßÄ ‡¶∏‡¶¶‡¶∞ | Feni Sadar", "‡¶¶‡¶æ‡¶ó‡¶®‡¶≠‡ßÇ‡¶û‡¶æ | Daganbhuiyan", "‡¶∏‡ßã‡¶®‡¶æ‡¶ó‡¶æ‡¶ú‡ßÄ | Sonagazi", "‡¶õ‡¶æ‡¶ó‡¶≤‡¶®‡¶æ‡¶á‡¶Ø‡¶º‡¶æ | Chhagalnaiya", "‡¶™‡¶∞‡¶∂‡ßÅ‡¶∞‡¶æ‡¶Æ | Parshuram", "‡¶´‡ßÅ‡¶≤‡¶ó‡¶æ‡¶ú‡ßÄ | Fulgazi"],
  "‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Æ‡ßÄ‡¶™‡ßÅ‡¶∞ | Lakshmipur": ["‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Æ‡ßÄ‡¶™‡ßÅ‡¶∞ ‡¶∏‡¶¶‡¶∞ | Lakshmipur Sadar", "‡¶∞‡¶æ‡¶Æ‡¶ó‡¶û‡ßç‡¶ú | Ramganj", "‡¶∞‡¶æ‡¶Ø‡¶º‡¶™‡ßÅ‡¶∞ | Raipur", "‡¶∞‡¶æ‡¶Æ‡¶ó‡¶§‡¶ø | Ramgati", "‡¶ï‡¶Æ‡¶≤‡¶®‡¶ó‡¶∞ | Kamalnagar"],
  "‡¶ñ‡¶æ‡¶ó‡¶°‡¶º‡¶æ‡¶õ‡¶°‡¶º‡¶ø | Khagrachari": ["‡¶ñ‡¶æ‡¶ó‡¶°‡¶º‡¶æ‡¶õ‡¶°‡¶º‡¶ø ‡¶∏‡¶¶‡¶∞ | Khagrachari Sadar", "‡¶¶‡ßÄ‡¶ò‡¶ø‡¶®‡¶æ‡¶≤‡¶æ | Dighinala", "‡¶™‡¶æ‡¶®‡¶õ‡¶°‡¶º‡¶ø | Panchari", "‡¶Æ‡¶π‡¶æ‡¶≤‡¶õ‡¶°‡¶º‡¶ø | Mahalchhari", "‡¶Æ‡¶æ‡¶ü‡¶ø‡¶∞‡¶æ‡¶ô‡ßç‡¶ó‡¶æ | Matiranga", "‡¶ó‡ßÅ‡¶á‡¶Æ‡¶æ‡¶∞‡¶æ | Guimara", "‡¶∞‡¶æ‡¶Æ‡¶ó‡¶°‡¶º | Ramgarh", "‡¶Æ‡¶æ‡¶®‡¶ø‡¶ï‡¶õ‡¶°‡¶º‡¶ø | Manikchhari", "‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Æ‡ßÄ‡¶õ‡¶°‡¶º‡¶ø | Lakshmichhari"],
  "‡¶∞‡¶æ‡¶ô‡ßç‡¶ó‡¶æ‡¶Æ‡¶æ‡¶ü‡¶ø | Rangamati": ["‡¶∞‡¶æ‡¶ô‡ßç‡¶ó‡¶æ‡¶Æ‡¶æ‡¶ü‡¶ø ‡¶∏‡¶¶‡¶∞ | Rangamati Sadar", "‡¶ï‡¶æ‡¶â‡¶ñ‡¶æ‡¶≤‡ßÄ | Kaukhali", "‡¶ï‡¶æ‡¶™‡ßç‡¶§‡¶æ‡¶á | Kaptai", "‡¶ú‡ßÅ‡¶∞‡¶æ‡¶õ‡¶°‡¶º‡¶ø | Juraichhari", "‡¶¨‡¶∞‡¶ï‡¶≤ | Barkal", "‡¶¨‡¶æ‡¶ò‡¶æ‡¶á‡¶õ‡¶°‡¶º‡¶ø | Baghaichhari", "‡¶≤‡¶Ç‡¶ó‡¶¶‡ßÅ | Langadu", "‡¶®‡¶æ‡¶®‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞‡¶ö‡¶∞ | Naniarchar", "‡¶¨‡¶ø‡¶≤‡¶æ‡¶á‡¶õ‡¶°‡¶º‡¶ø | Belaichhari", "‡¶∞‡¶æ‡¶ú‡¶∏‡ßç‡¶•‡¶≤‡ßÄ | Rajasthali"],
  "‡¶¨‡¶æ‡¶®‡ßç‡¶¶‡¶∞‡¶¨‡¶æ‡¶® | Bandarban": ["‡¶¨‡¶æ‡¶®‡ßç‡¶¶‡¶∞‡¶¨‡¶æ‡¶® ‡¶∏‡¶¶‡¶∞ | Bandarban Sadar", "‡¶∞‡ßã‡¶Ø‡¶º‡¶æ‡¶Ç‡¶õ‡¶°‡¶º‡¶ø | Rowangchhari", "‡¶∞‡ßÅ‡¶Æ‡¶æ | Ruma", "‡¶•‡¶æ‡¶®‡¶ö‡¶ø | Thanchi", "‡¶≤‡¶æ‡¶Æ‡¶æ | Lama", "‡¶Ü‡¶≤‡ßÄ‡¶ï‡¶¶‡¶Æ | Alikadam", "‡¶®‡¶æ‡¶á‡¶ï‡ßç‡¶∑‡ßç‡¶Ø‡¶Ç‡¶õ‡¶°‡¶º‡¶ø | Naikhongchhari"],
  "‡¶∞‡¶æ‡¶ú‡¶∂‡¶æ‡¶π‡ßÄ | Rajshahi": ["‡¶∞‡¶æ‡¶ú‡¶∂‡¶æ‡¶π‡ßÄ ‡¶∏‡¶¶‡¶∞ | Rajshahi Sadar", "‡¶ó‡ßã‡¶¶‡¶æ‡¶ó‡¶æ‡¶°‡¶º‡ßÄ | Godagari", "‡¶§‡¶æ‡¶®‡ßã‡¶∞ | Tanore", "‡¶Æ‡ßã‡¶π‡¶®‡¶™‡ßÅ‡¶∞ | Mohanpur", "‡¶¨‡¶æ‡¶ó‡¶Æ‡¶æ‡¶∞‡¶æ | Bagmara", "‡¶¶‡ßÅ‡¶∞‡ßç‡¶ó‡¶æ‡¶™‡ßÅ‡¶∞ | Durgapur", "‡¶™‡ßÅ‡¶†‡¶ø‡¶Ø‡¶º‡¶æ | Puthia", "‡¶ö‡¶æ‡¶∞‡¶ò‡¶æ‡¶ü | Charghat", "‡¶¨‡¶æ‡¶ò‡¶æ | Bagha"],
  "‡¶¨‡¶ó‡ßÅ‡¶°‡¶º‡¶æ | Bogura Bogra": ["‡¶¨‡¶ó‡ßÅ‡¶°‡¶º‡¶æ ‡¶∏‡¶¶‡¶∞ | Bogura Sadar", "‡¶∂‡¶æ‡¶ú‡¶æ‡¶π‡¶æ‡¶®‡¶™‡ßÅ‡¶∞ | Shajahanpur", "‡¶∂‡¶ø‡¶¨‡¶ó‡¶û‡ßç‡¶ú | Shibganj", "‡¶∏‡ßã‡¶®‡¶æ‡¶§‡¶≤‡¶æ | Sonatala", "‡¶ó‡¶æ‡¶¨‡¶§‡¶≤‡ßÄ | Gabtali", "‡¶∏‡¶æ‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ‡¶ï‡¶æ‡¶®‡ßç‡¶¶‡¶ø | Sariakandi", "‡¶ß‡ßÅ‡¶®‡¶ü | Dhunat", "‡¶∂‡ßá‡¶∞‡¶™‡ßÅ‡¶∞ | Sherpur", "‡¶®‡¶®‡ßç‡¶¶‡ßÄ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ | Nandigram", "‡¶ï‡¶æ‡¶π‡¶æ‡¶≤‡ßÅ | Kahaloo", "‡¶¶‡ßÅ‡¶™‡¶ö‡¶æ‡¶Å‡¶ö‡¶ø‡¶Ø‡¶º‡¶æ | Dupchanchia", "‡¶Ü‡¶¶‡¶Æ‡¶¶‡ßÄ‡¶ò‡¶ø | Adamdighi"],
  "‡¶®‡¶ì‡¶ó‡¶æ‡¶Å | Naogaon": ["‡¶®‡¶ì‡¶ó‡¶æ‡¶Å ‡¶∏‡¶¶‡¶∞ | Naogaon Sadar", "‡¶Æ‡¶π‡¶æ‡¶¶‡ßá‡¶¨‡¶™‡ßÅ‡¶∞ | Mohadevpur", "‡¶¨‡¶¶‡¶≤‡¶ó‡¶æ‡¶õ‡ßÄ | Badalgachhi", "‡¶™‡¶§‡ßç‡¶®‡ßÄ‡¶§‡¶≤‡¶æ | Patnitala", "‡¶ß‡¶æ‡¶Æ‡¶á‡¶∞‡¶π‡¶æ‡¶ü | Dhamoirhat", "‡¶∏‡¶æ‡¶™‡¶æ‡¶π‡¶æ‡¶∞ | Sapahar", "‡¶™‡ßã‡¶∞‡¶∂‡¶æ | Porsha", "‡¶Æ‡¶æ‡¶®‡ßç‡¶¶‡¶æ | Manda", "‡¶®‡¶ø‡¶Ø‡¶º‡¶æ‡¶Æ‡¶§‡¶™‡ßÅ‡¶∞ | Niamatpur", "‡¶Ü‡¶§‡ßç‡¶∞‡¶æ‡¶á | Atrai", "‡¶∞‡¶æ‡¶£‡ßÄ‡¶®‡¶ó‡¶∞ | Raninagar"],
  "‡¶®‡¶æ‡¶ü‡ßã‡¶∞ | Natore": ["‡¶®‡¶æ‡¶ü‡ßã‡¶∞ ‡¶∏‡¶¶‡¶∞ | Natore Sadar", "‡¶®‡¶≤‡¶°‡¶æ‡¶ô‡ßç‡¶ó‡¶æ | Naldanga", "‡¶∏‡¶ø‡¶Ç‡¶°‡¶º‡¶æ | Singra", "‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶¶‡¶æ‡¶∏‡¶™‡ßÅ‡¶∞ | Gurudaspur", "‡¶¨‡¶°‡¶º‡¶æ‡¶á‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ | Baraigram", "‡¶≤‡¶æ‡¶≤‡¶™‡ßÅ‡¶∞ | Lalpur", "‡¶¨‡¶æ‡¶ó‡¶æ‡¶§‡¶ø‡¶™‡¶æ‡¶°‡¶º‡¶æ | Bagatipara"],
  "‡¶ö‡¶æ‡¶Å‡¶™‡¶æ‡¶á‡¶®‡¶¨‡¶æ‡¶¨‡¶ó‡¶û‡ßç‡¶ú | Chapainawabganj Nawabganj": ["‡¶ö‡¶æ‡¶Å‡¶™‡¶æ‡¶á‡¶®‡¶¨‡¶æ‡¶¨‡¶ó‡¶û‡ßç‡¶ú ‡¶∏‡¶¶‡¶∞ | Chapainawabganj Sadar", "‡¶∂‡¶ø‡¶¨‡¶ó‡¶û‡ßç‡¶ú | Shibganj", "‡¶ó‡ßã‡¶Æ‡¶∏‡ßç‡¶§‡¶æ‡¶™‡ßÅ‡¶∞ | Gomastapur", "‡¶®‡¶æ‡¶ö‡ßã‡¶≤ | Nachole", "‡¶≠‡ßã‡¶≤‡¶æ‡¶π‡¶æ‡¶ü | Bholahat"],
  "‡¶™‡¶æ‡¶¨‡¶®‡¶æ | Pabna": ["‡¶™‡¶æ‡¶¨‡¶®‡¶æ ‡¶∏‡¶¶‡¶∞ | Pabna Sadar", "‡¶à‡¶∂‡ßç‡¶¨‡¶∞‡¶¶‡ßÄ | Ishwardi", "‡¶Ü‡¶ü‡¶ò‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ | Atgharia", "‡¶ö‡¶æ‡¶ü‡¶Æ‡ßã‡¶π‡¶∞ | Chatmohar", "‡¶≠‡¶æ‡¶ô‡ßç‡¶ó‡ßÅ‡¶∞‡¶æ | Bhangura", "‡¶´‡¶∞‡¶ø‡¶¶‡¶™‡ßÅ‡¶∞ | Faridpur", "‡¶∏‡ßÅ‡¶ú‡¶æ‡¶®‡¶ó‡¶∞ | Sujanagar", "‡¶¨‡ßá‡¶°‡¶º‡¶æ | Bera", "‡¶∏‡¶æ‡¶Å‡¶•‡¶ø‡¶Ø‡¶º‡¶æ | Santhia"],
  "‡¶∏‡¶ø‡¶∞‡¶æ‡¶ú‡¶ó‡¶û‡ßç‡¶ú | Sirajganj": ["‡¶∏‡¶ø‡¶∞‡¶æ‡¶ú‡¶ó‡¶û‡ßç‡¶ú ‡¶∏‡¶¶‡¶∞ | Sirajganj Sadar", "‡¶¨‡ßá‡¶≤‡¶ï‡ßÅ‡¶ö‡¶ø | Belkuchi", "‡¶ö‡ßå‡¶π‡¶æ‡¶≤‡ßÄ | Chauhali", "‡¶ï‡¶æ‡¶Æ‡¶æ‡¶∞‡¶ñ‡¶®‡ßç‡¶¶ | Kamarkhanda", "‡¶ï‡¶æ‡¶ú‡ßÄ‡¶™‡ßÅ‡¶∞ | Kazipur", "‡¶∞‡¶æ‡¶Ø‡¶º‡¶ó‡¶û‡ßç‡¶ú | Raiganj", "‡¶∂‡¶æ‡¶π‡¶ú‡¶æ‡¶¶‡¶™‡ßÅ‡¶∞ | Shahjadpur", "‡¶§‡¶æ‡¶°‡¶º‡¶æ‡¶∂ | Tarash", "‡¶â‡¶≤‡ßç‡¶≤‡¶æ‡¶™‡¶æ‡¶°‡¶º‡¶æ | Ullapara"],
  "‡¶ú‡¶Ø‡¶º‡¶™‡ßÅ‡¶∞‡¶π‡¶æ‡¶ü | Joypurhat": ["‡¶ú‡¶Ø‡¶º‡¶™‡ßÅ‡¶∞‡¶π‡¶æ‡¶ü ‡¶∏‡¶¶‡¶∞ | Joypurhat Sadar", "‡¶™‡¶æ‡¶Å‡¶ö‡¶¨‡¶ø‡¶¨‡¶ø | Panchbibi", "‡¶Ü‡¶ï‡ßç‡¶ï‡ßá‡¶≤‡¶™‡ßÅ‡¶∞ | Akkelpur", "‡¶ï‡¶æ‡¶≤‡¶æ‡¶á | Kalai", "‡¶ï‡ßç‡¶∑‡ßá‡¶§‡¶≤‡¶æ‡¶≤ | Khetlal"],
  "‡¶∞‡¶Ç‡¶™‡ßÅ‡¶∞ | Rangpur": ["‡¶∞‡¶Ç‡¶™‡ßÅ‡¶∞ ‡¶∏‡¶¶‡¶∞ | Rangpur Sadar", "‡¶ó‡¶ô‡ßç‡¶ó‡¶æ‡¶ö‡¶°‡¶º‡¶æ | Gangachara", "‡¶§‡¶æ‡¶∞‡¶æ‡¶ó‡¶û‡ßç‡¶ú | Taraganj", "‡¶¨‡¶¶‡¶∞‡¶ó‡¶û‡ßç‡¶ú | Badarganj", "‡¶Æ‡¶ø‡¶†‡¶æ‡¶™‡ßÅ‡¶ï‡ßÅ‡¶∞ | Mithapukur", "‡¶™‡ßÄ‡¶∞‡¶ó‡¶û‡ßç‡¶ú | Pirganj", "‡¶™‡ßÄ‡¶∞‡¶ó‡¶æ‡¶õ‡¶æ | Pirgacha", "‡¶ï‡¶æ‡¶â‡¶®‡¶ø‡¶Ø‡¶º‡¶æ | Kaunia"],
  "‡¶¶‡¶ø‡¶®‡¶æ‡¶ú‡¶™‡ßÅ‡¶∞ | Dinajpur": ["‡¶¶‡¶ø‡¶®‡¶æ‡¶ú‡¶™‡ßÅ‡¶∞ ‡¶∏‡¶¶‡¶∞ | Dinajpur Sadar", "‡¶¨‡¶ø‡¶∞‡¶≤ | Birol", "‡¶¨‡ßã‡¶ö‡¶æ‡¶ó‡¶û‡ßç‡¶ú | Bochaganj", "‡¶ï‡¶æ‡¶π‡¶æ‡¶∞‡ßã‡¶≤ | Kaharol", "‡¶¨‡ßÄ‡¶∞‡¶ó‡¶û‡ßç‡¶ú | Birganj", "‡¶ñ‡¶æ‡¶®‡¶∏‡¶æ‡¶Æ‡¶æ | Khansama", "‡¶ö‡¶ø‡¶∞‡¶ø‡¶∞‡¶¨‡¶®‡ßç‡¶¶‡¶∞ | Chirirbandar", "‡¶™‡¶æ‡¶∞‡ßç‡¶¨‡¶§‡ßÄ‡¶™‡ßÅ‡¶∞ | Parbatipur", "‡¶´‡ßÅ‡¶≤‡¶¨‡¶æ‡¶°‡¶º‡ßÄ | Phulbari", "‡¶®‡¶¨‡¶æ‡¶¨‡¶ó‡¶û‡ßç‡¶ú | Nawabganj", "‡¶¨‡¶ø‡¶∞‡¶æ‡¶Æ‡¶™‡ßÅ‡¶∞ | Birampur", "‡¶π‡¶æ‡¶ï‡¶ø‡¶Æ‡¶™‡ßÅ‡¶∞ | Hakimpur", "‡¶ò‡ßã‡¶°‡¶º‡¶æ‡¶ò‡¶æ‡¶ü | Ghoraghat"],
  "‡¶ó‡¶æ‡¶á‡¶¨‡¶æ‡¶®‡ßç‡¶ß‡¶æ | Gaibandha": ["‡¶ó‡¶æ‡¶á‡¶¨‡¶æ‡¶®‡ßç‡¶ß‡¶æ ‡¶∏‡¶¶‡¶∞ | Gaibandha Sadar", "‡¶∏‡¶æ‡¶¶‡ßÅ‡¶≤‡ßç‡¶≤‡¶æ‡¶™‡ßÅ‡¶∞ | Sadullapur", "‡¶™‡¶≤‡¶æ‡¶∂‡¶¨‡¶æ‡¶°‡¶º‡ßÄ | Palashbari", "‡¶ó‡ßã‡¶¨‡¶ø‡¶®‡ßç‡¶¶‡¶ó‡¶û‡ßç‡¶ú | Gobindaganj", "‡¶∏‡¶æ‡¶ò‡¶æ‡¶ü‡¶æ | Saghata", "‡¶´‡ßÅ‡¶≤‡¶õ‡¶°‡¶º‡¶ø | Phulchhari", "‡¶∏‡ßÅ‡¶®‡ßç‡¶¶‡¶∞‡¶ó‡¶û‡ßç‡¶ú | Sundarganj"],
  "‡¶ï‡ßÅ‡¶°‡¶º‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ | Kurigram": ["‡¶ï‡ßÅ‡¶°‡¶º‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶∏‡¶¶‡¶∞ | Kurigram Sadar", "‡¶∞‡¶æ‡¶ú‡¶æ‡¶∞‡¶π‡¶æ‡¶ü | Rajarhat", "‡¶â‡¶≤‡¶ø‡¶™‡ßÅ‡¶∞ | Ulipur", "‡¶ö‡¶ø‡¶≤‡¶Æ‡¶æ‡¶∞‡ßÄ | Chilmari", "‡¶∞‡ßå‡¶Æ‡¶æ‡¶∞‡ßÄ | Roumari", "‡¶∞‡¶æ‡¶ú‡ßÄ‡¶¨‡¶™‡ßÅ‡¶∞ | Rajibpur", "‡¶®‡¶æ‡¶ó‡ßá‡¶∂‡ßç‡¶¨‡¶∞‡ßÄ | Nageshwari", "‡¶≠‡ßÅ‡¶∞‡ßÅ‡¶ô‡ßç‡¶ó‡¶æ‡¶Æ‡¶æ‡¶∞‡ßÄ | Bhurungamari", "‡¶´‡ßÅ‡¶≤‡¶¨‡¶æ‡¶°‡¶º‡ßÄ | Phulbari"],
  "‡¶®‡ßÄ‡¶≤‡¶´‡¶æ‡¶Æ‡¶æ‡¶∞‡ßÄ | Nilphamari": ["‡¶®‡ßÄ‡¶≤‡¶´‡¶æ‡¶Æ‡¶æ‡¶∞‡ßÄ ‡¶∏‡¶¶‡¶∞ | Nilphamari Sadar", "‡¶∏‡ßà‡¶Ø‡¶º‡¶¶‡¶™‡ßÅ‡¶∞ | Saidpur", "‡¶ú‡¶≤‡¶¢‡¶æ‡¶ï‡¶æ | Jaldhaka", "‡¶ï‡¶ø‡¶∂‡ßã‡¶∞‡¶ó‡¶û‡ßç‡¶ú | Kishoreganj", "‡¶°‡ßã‡¶Æ‡¶æ‡¶∞ | Domar", "‡¶°‡¶ø‡¶Æ‡¶≤‡¶æ | Dimla"],
  "‡¶≤‡¶æ‡¶≤‡¶Æ‡¶®‡¶ø‡¶∞‡¶π‡¶æ‡¶ü | Lalmonirhat": ["‡¶≤‡¶æ‡¶≤‡¶Æ‡¶®‡¶ø‡¶∞‡¶π‡¶æ‡¶ü ‡¶∏‡¶¶‡¶∞ | Lalmonirhat Sadar", "‡¶Ü‡¶¶‡¶ø‡¶§‡¶Æ‡¶æ‡¶∞‡ßÄ | Aditmari", "‡¶ï‡¶æ‡¶≤‡ßÄ‡¶ó‡¶û‡ßç‡¶ú | Kaliganj", "‡¶π‡¶æ‡¶§‡ßÄ‡¶¨‡¶æ‡¶®‡ßç‡¶ß‡¶æ | Hatibandha", "‡¶™‡¶æ‡¶ü‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ | Patgram"],
  "‡¶†‡¶æ‡¶ï‡ßÅ‡¶∞‡¶ó‡¶æ‡¶Å‡¶ì | Thakurgaon": ["‡¶†‡¶æ‡¶ï‡ßÅ‡¶∞‡¶ó‡¶æ‡¶Å‡¶ì ‡¶∏‡¶¶‡¶∞ | Thakurgaon Sadar", "‡¶™‡ßÄ‡¶∞‡¶ó‡¶û‡ßç‡¶ú | Pirganj", "‡¶∞‡¶æ‡¶®‡ßÄ‡¶∂‡¶Ç‡¶ï‡ßà‡¶≤ | Ranisankail", "‡¶¨‡¶æ‡¶≤‡¶ø‡¶Ø‡¶º‡¶æ‡¶°‡¶æ‡¶ô‡ßç‡¶ó‡ßÄ | Baliadangi", "‡¶π‡¶∞‡¶ø‡¶™‡ßÅ‡¶∞ | Haripur"],
  "‡¶™‡¶û‡ßç‡¶ö‡¶ó‡¶°‡¶º | Panchagarh": ["‡¶™‡¶û‡ßç‡¶ö‡¶ó‡¶°‡¶º ‡¶∏‡¶¶‡¶∞ | Panchagarh Sadar", "‡¶¨‡ßã‡¶¶‡¶æ | Boda", "‡¶¶‡ßá‡¶¨‡ßÄ‡¶ó‡¶û‡ßç‡¶ú | Debiganj", "‡¶Ü‡¶ü‡ßã‡¶Ø‡¶º‡¶æ‡¶∞‡ßÄ | Atwari", "‡¶§‡ßá‡¶Å‡¶§‡ßÅ‡¶≤‡¶ø‡¶Ø‡¶º‡¶æ | Tetulia"],
  "‡¶ñ‡ßÅ‡¶≤‡¶®‡¶æ | Khulna": ["‡¶ñ‡ßÅ‡¶≤‡¶®‡¶æ ‡¶∏‡¶¶‡¶∞ | Khulna Sadar", "‡¶¨‡¶ü‡¶ø‡¶Ø‡¶º‡¶æ‡¶ò‡¶æ‡¶ü‡¶æ | Batiaghata", "‡¶°‡ßÅ‡¶Æ‡ßÅ‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ | Dumuria", "‡¶´‡ßÅ‡¶≤‡¶§‡¶≤‡¶æ | Phultala", "‡¶¶‡¶ø‡¶ò‡¶≤‡¶ø‡¶Ø‡¶º‡¶æ | Dighalia", "‡¶∞‡ßÇ‡¶™‡¶∏‡¶æ | Rupsha", "‡¶§‡ßá‡¶∞‡¶ñ‡¶æ‡¶¶‡¶æ | Terokhada", "‡¶ï‡¶Ø‡¶º‡¶∞‡¶æ | Koyra", "‡¶™‡¶æ‡¶á‡¶ï‡¶ó‡¶æ‡¶õ‡¶æ | Paikgachha", "‡¶¶‡¶æ‡¶ï‡ßã‡¶™ | Dacope"],
  "‡¶Ø‡¶∂‡ßã‡¶∞ | Jashore Jessore": ["‡¶Ø‡¶∂‡ßã‡¶∞ ‡¶∏‡¶¶‡¶∞ | Jashore Sadar", "‡¶¨‡¶æ‡¶ò‡¶æ‡¶∞‡¶™‡¶æ‡¶°‡¶º‡¶æ | Bagherpara", "‡¶Ö‡¶≠‡¶Ø‡¶º‡¶®‡¶ó‡¶∞ | Abhaynagar", "‡¶Æ‡¶®‡¶ø‡¶∞‡¶æ‡¶Æ‡¶™‡ßÅ‡¶∞ | Manirampur", "‡¶ï‡ßá‡¶∂‡¶¨‡¶™‡ßÅ‡¶∞ | Keshabpur", "‡¶ö‡ßå‡¶ó‡¶æ‡¶õ‡¶æ | Chaugachha", "‡¶ù‡¶ø‡¶ï‡¶∞‡¶ó‡¶æ‡¶õ‡¶æ | Jhikargachha", "‡¶∂‡¶æ‡¶∞‡ßç‡¶∂‡¶æ | Sharsha"],
  "‡¶∏‡¶æ‡¶§‡¶ï‡ßç‡¶∑‡ßÄ‡¶∞‡¶æ | Satkhira": ["‡¶∏‡¶æ‡¶§‡¶ï‡ßç‡¶∑‡ßÄ‡¶∞‡¶æ ‡¶∏‡¶¶‡¶∞ | Satkhira Sadar", "‡¶ï‡¶≤‡¶æ‡¶∞‡ßã‡¶Ø‡¶º‡¶æ | Kalaroa", "‡¶§‡¶æ‡¶≤‡¶æ | Tala", "‡¶Ü‡¶∂‡¶æ‡¶∂‡ßÅ‡¶®‡¶ø | Assasuni", "‡¶¶‡ßá‡¶¨‡¶π‡¶æ‡¶ü‡¶æ | Debhata", "‡¶ï‡¶æ‡¶≤‡ßÄ‡¶ó‡¶û‡ßç‡¶ú | Kaliganj", "‡¶∂‡ßç‡¶Ø‡¶æ‡¶Æ‡¶®‡¶ó‡¶∞ | Shyamnagar"],
  "‡¶¨‡¶æ‡¶ó‡ßá‡¶∞‡¶π‡¶æ‡¶ü | Bagerhat": ["‡¶¨‡¶æ‡¶ó‡ßá‡¶∞‡¶π‡¶æ‡¶ü ‡¶∏‡¶¶‡¶∞ | Bagerhat Sadar", "‡¶´‡¶ï‡¶ø‡¶∞‡¶π‡¶æ‡¶ü | Fakirhat", "‡¶Æ‡ßã‡¶≤‡ßç‡¶≤‡¶æ‡¶π‡¶æ‡¶ü | Mollahat", "‡¶ö‡¶ø‡¶§‡¶≤‡¶Æ‡¶æ‡¶∞‡ßÄ | Chitalmari", "‡¶ï‡¶ö‡ßÅ‡¶Ø‡¶º‡¶æ | Kachua", "‡¶∞‡¶æ‡¶Æ‡¶™‡¶æ‡¶≤ | Rampal", "‡¶Æ‡ßã‡¶Ç‡¶≤‡¶æ | Mongla", "‡¶Æ‡ßã‡¶∞‡ßá‡¶≤‡¶ó‡¶û‡ßç‡¶ú | Morrelganj", "‡¶∂‡¶∞‡¶£‡¶ñ‡ßã‡¶≤‡¶æ | Sarankhola"],
  "‡¶ù‡¶ø‡¶®‡¶æ‡¶á‡¶¶‡¶π | Jhenaidah": ["‡¶ù‡¶ø‡¶®‡¶æ‡¶á‡¶¶‡¶π ‡¶∏‡¶¶‡¶∞ | Jhenaidah Sadar", "‡¶∂‡ßà‡¶≤‡¶ï‡ßÅ‡¶™‡¶æ | Shailkupa", "‡¶π‡¶∞‡¶ø‡¶£‡¶æ‡¶ï‡ßÅ‡¶®‡ßç‡¶°‡ßÅ | Harinakunda", "‡¶ï‡¶æ‡¶≤‡ßÄ‡¶ó‡¶û‡ßç‡¶ú | Kaliganj", "‡¶ï‡ßã‡¶ü‡¶ö‡¶æ‡¶Å‡¶¶‡¶™‡ßÅ‡¶∞ | Kotchandpur", "‡¶Æ‡¶π‡ßá‡¶∂‡¶™‡ßÅ‡¶∞ | Moheshpur"],
  "‡¶ö‡ßÅ‡¶Ø‡¶º‡¶æ‡¶°‡¶æ‡¶ô‡ßç‡¶ó‡¶æ | Chuadanga": ["‡¶ö‡ßÅ‡¶Ø‡¶º‡¶æ‡¶°‡¶æ‡¶ô‡ßç‡¶ó‡¶æ ‡¶∏‡¶¶‡¶∞ | Chuadanga Sadar", "‡¶Ü‡¶≤‡¶Æ‡¶°‡¶æ‡¶ô‡ßç‡¶ó‡¶æ | Alamdanga", "‡¶¶‡¶æ‡¶Æ‡ßÅ‡¶°‡¶º‡¶π‡ßÅ‡¶¶‡¶æ | Damurhuda", "‡¶ú‡ßÄ‡¶¨‡¶®‡¶®‡¶ó‡¶∞ | Jibannagar"],
  "‡¶ï‡ßÅ‡¶∑‡ßç‡¶ü‡¶ø‡¶Ø‡¶º‡¶æ | Kushtia": ["‡¶ï‡ßÅ‡¶∑‡ßç‡¶ü‡¶ø‡¶Ø‡¶º‡¶æ ‡¶∏‡¶¶‡¶∞ | Kushtia Sadar", "‡¶ï‡ßÅ‡¶Æ‡¶æ‡¶∞‡¶ñ‡¶æ‡¶≤‡ßÄ | Kumarkhali", "‡¶ñ‡ßã‡¶ï‡¶∏‡¶æ | Khoksa", "‡¶Æ‡¶ø‡¶∞‡¶™‡ßÅ‡¶∞ | Mirpur", "‡¶≠‡ßá‡¶°‡¶º‡¶æ‡¶Æ‡¶æ‡¶∞‡¶æ | Bheramara", "‡¶¶‡ßå‡¶≤‡¶§‡¶™‡ßÅ‡¶∞ | Daulatpur"],
  "‡¶Æ‡ßá‡¶π‡ßá‡¶∞‡¶™‡ßÅ‡¶∞ | Meherpur": ["‡¶Æ‡ßá‡¶π‡ßá‡¶∞‡¶™‡ßÅ‡¶∞ ‡¶∏‡¶¶‡¶∞ | Meherpur Sadar", "‡¶ó‡¶æ‡¶Ç‡¶®‡ßÄ | Gangni", "‡¶Æ‡ßÅ‡¶ú‡¶ø‡¶¨‡¶®‡¶ó‡¶∞ | Mujibnagar"],
  "‡¶Æ‡¶æ‡¶ó‡ßÅ‡¶∞‡¶æ | Magura": ["‡¶Æ‡¶æ‡¶ó‡ßÅ‡¶∞‡¶æ ‡¶∏‡¶¶‡¶∞ | Magura Sadar", "‡¶∂‡ßç‡¶∞‡ßÄ‡¶™‡ßÅ‡¶∞ | Sreepur", "‡¶∂‡¶æ‡¶≤‡¶ø‡¶ñ‡¶æ | Shalikha", "‡¶Æ‡¶π‡¶Æ‡ßç‡¶Æ‡¶¶‡¶™‡ßÅ‡¶∞ | Mohammadpur"],
  "‡¶®‡¶°‡¶º‡¶æ‡¶á‡¶≤ | Narail": ["‡¶®‡¶°‡¶º‡¶æ‡¶á‡¶≤ ‡¶∏‡¶¶‡¶∞ | Narail Sadar", "‡¶≤‡ßã‡¶π‡¶æ‡¶ó‡¶°‡¶º‡¶æ | Lohagara", "‡¶ï‡¶æ‡¶≤‡¶ø‡¶Ø‡¶º‡¶æ | Kalia"],
  "‡¶¨‡¶∞‡¶ø‡¶∂‡¶æ‡¶≤ | Barishal Barisal": ["‡¶¨‡¶∞‡¶ø‡¶∂‡¶æ‡¶≤ ‡¶∏‡¶¶‡¶∞ | Barishal Sadar", "‡¶¨‡¶æ‡¶¨‡ßÅ‡¶ó‡¶û‡ßç‡¶ú | Babuganj", "‡¶â‡¶ú‡¶ø‡¶∞‡¶™‡ßÅ‡¶∞ | Wazirpur", "‡¶¨‡¶æ‡¶ï‡ßá‡¶∞‡¶ó‡¶û‡ßç‡¶ú | Bakerganj", "‡¶ó‡ßå‡¶∞‡¶®‡¶¶‡ßÄ | Gournadi", "‡¶Ü‡¶ó‡ßà‡¶≤‡¶ù‡¶æ‡¶°‡¶º‡¶æ | Agailjhara", "‡¶¨‡¶æ‡¶®‡¶æ‡¶∞‡ßÄ‡¶™‡¶æ‡¶°‡¶º‡¶æ | Banaripara", "‡¶Æ‡ßÅ‡¶≤‡¶æ‡¶¶‡ßÄ | Muladi", "‡¶π‡¶ø‡¶ú‡¶≤‡¶æ | Hizla", "‡¶Æ‡ßá‡¶π‡ßá‡¶®‡ßç‡¶¶‡¶ø‡¶ó‡¶û‡ßç‡¶ú | Mehendiganj"],
  "‡¶™‡¶ü‡ßÅ‡¶Ø‡¶º‡¶æ‡¶ñ‡¶æ‡¶≤‡ßÄ | Patuakhali": ["‡¶™‡¶ü‡ßÅ‡¶Ø‡¶º‡¶æ‡¶ñ‡¶æ‡¶≤‡ßÄ ‡¶∏‡¶¶‡¶∞ | Patuakhali Sadar", "‡¶¶‡ßÅ‡¶Æ‡¶ï‡¶ø | Dumki", "‡¶Æ‡¶ø‡¶∞‡ßç‡¶ú‡¶æ‡¶ó‡¶û‡ßç‡¶ú | Mirzaganj", "‡¶¨‡¶æ‡¶â‡¶´‡¶≤ | Bauphal", "‡¶¶‡¶∂‡¶Æ‡¶ø‡¶®‡¶æ | Dashmina", "‡¶ó‡¶≤‡¶æ‡¶ö‡¶ø‡¶™‡¶æ | Galachipa", "‡¶ï‡¶≤‡¶æ‡¶™‡¶æ‡¶°‡¶º‡¶æ | Kalapara", "‡¶∞‡¶æ‡¶ô‡ßç‡¶ó‡¶æ‡¶¨‡¶æ‡¶≤‡ßÄ | Rangabali"],
  "‡¶≠‡ßã‡¶≤‡¶æ | Bhola": ["‡¶≠‡ßã‡¶≤‡¶æ ‡¶∏‡¶¶‡¶∞ | Bhola Sadar", "‡¶¶‡ßå‡¶≤‡¶§‡¶ñ‡¶æ‡¶® | Daulatkhan", "‡¶¨‡ßã‡¶∞‡¶π‡¶æ‡¶®‡¶â‡¶¶‡ßç‡¶¶‡¶ø‡¶® | Borhanuddin", "‡¶§‡¶ú‡ßÅ‡¶Æ‡¶¶‡ßç‡¶¶‡¶ø‡¶® | Tazumuddin", "‡¶≤‡¶æ‡¶≤‡¶Æ‡ßã‡¶π‡¶® | Lalmohan", "‡¶ö‡¶∞‡¶´‡ßç‡¶Ø‡¶æ‡¶∂‡¶® | Char Fasson", "‡¶Æ‡¶®‡¶™‡ßÅ‡¶∞‡¶æ | Monpura"],
  "‡¶™‡¶ø‡¶∞‡ßã‡¶ú‡¶™‡ßÅ‡¶∞ | Pirojpur": ["‡¶™‡¶ø‡¶∞‡ßã‡¶ú‡¶™‡ßÅ‡¶∞ ‡¶∏‡¶¶‡¶∞ | Pirojpur Sadar", "‡¶®‡ßá‡¶õ‡¶æ‡¶∞‡¶æ‡¶¨‡¶æ‡¶¶ | Nesarabad", "‡¶ï‡¶æ‡¶â‡¶ñ‡¶æ‡¶≤‡ßÄ | Kaukhali", "‡¶≠‡¶æ‡¶®‡ßç‡¶°‡¶æ‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ | Bhandaria", "‡¶Æ‡¶†‡¶¨‡¶æ‡¶°‡¶º‡¶ø‡¶Ø‡¶º‡¶æ | Mathbaria", "‡¶®‡¶æ‡¶ú‡¶ø‡¶∞‡¶™‡ßÅ‡¶∞ | Nazirpur", "‡¶á‡¶®‡ßç‡¶¶‡ßÅ‡¶∞‡¶ï‡¶æ‡¶®‡ßÄ | Indurkani"],
  "‡¶¨‡¶∞‡¶ó‡ßÅ‡¶®‡¶æ | Barguna": ["‡¶¨‡¶∞‡¶ó‡ßÅ‡¶®‡¶æ ‡¶∏‡¶¶‡¶∞ | Barguna Sadar", "‡¶Ü‡¶Æ‡¶§‡¶≤‡ßÄ | Amtali", "‡¶§‡¶æ‡¶≤‡¶§‡¶≤‡ßÄ | Taltali", "‡¶™‡¶æ‡¶•‡¶∞‡¶ò‡¶æ‡¶ü‡¶æ | Patharghata", "‡¶¨‡¶æ‡¶Æ‡¶®‡¶æ | Bamna", "‡¶¨‡ßá‡¶§‡¶æ‡¶ó‡ßÄ | Betagi"],
  "‡¶ù‡¶æ‡¶≤‡¶ï‡¶æ‡¶†‡¶ø | Jhalokati": ["‡¶ù‡¶æ‡¶≤‡¶ï‡¶æ‡¶†‡¶ø ‡¶∏‡¶¶‡¶∞ | Jhalokati Sadar", "‡¶®‡¶≤‡¶õ‡¶ø‡¶ü‡¶ø | Nalchity", "‡¶∞‡¶æ‡¶ú‡¶æ‡¶™‡ßÅ‡¶∞ | Rajapur", "‡¶ï‡¶æ‡¶Å‡¶†‡¶æ‡¶≤‡¶ø‡¶Ø‡¶º‡¶æ | Kathalia"],
  "‡¶∏‡¶ø‡¶≤‡ßá‡¶ü | Sylhet": ["‡¶∏‡¶ø‡¶≤‡ßá‡¶ü ‡¶∏‡¶¶‡¶∞ | Sylhet Sadar", "‡¶¶‡¶ï‡ßç‡¶∑‡¶ø‡¶£ ‡¶∏‡ßÅ‡¶∞‡¶Æ‡¶æ | Dakshin Surma", "‡¶¨‡¶ø‡¶∂‡ßç‡¶¨‡¶®‡¶æ‡¶• | Bishwanath", "‡¶ì‡¶∏‡¶Æ‡¶æ‡¶®‡ßÄ‡¶®‡¶ó‡¶∞ | Osmaninagar", "‡¶¨‡¶æ‡¶≤‡¶æ‡¶ó‡¶û‡ßç‡¶ú | Balaganj", "‡¶´‡ßá‡¶û‡ßç‡¶ö‡ßÅ‡¶ó‡¶û‡ßç‡¶ú | Fenchuganj", "‡¶ó‡ßã‡¶≤‡¶æ‡¶™‡¶ó‡¶û‡ßç‡¶ú | Golapganj", "‡¶¨‡¶ø‡¶Ø‡¶º‡¶æ‡¶®‡ßÄ‡¶¨‡¶æ‡¶ú‡¶æ‡¶∞ | Beanibazar", "‡¶ú‡¶ï‡¶ø‡¶ó‡¶û‡ßç‡¶ú | Zakiganj", "‡¶ï‡¶æ‡¶®‡¶æ‡¶á‡¶ò‡¶æ‡¶ü | Kanaighat", "‡¶ú‡ßà‡¶®‡ßç‡¶§‡¶æ‡¶™‡ßÅ‡¶∞ | Jaintiapur", "‡¶ó‡ßã‡¶Ø‡¶º‡¶æ‡¶á‡¶®‡¶ò‡¶æ‡¶ü | Gowainghat", "‡¶ï‡ßã‡¶Æ‡ßç‡¶™‡¶æ‡¶®‡ßÄ‡¶ó‡¶û‡ßç‡¶ú | Companiganj"],
  "‡¶Æ‡ßå‡¶≤‡¶≠‡ßÄ‡¶¨‡¶æ‡¶ú‡¶æ‡¶∞ | Moulvibazar": ["‡¶Æ‡ßå‡¶≤‡¶≠‡ßÄ‡¶¨‡¶æ‡¶ú‡¶æ‡¶∞ ‡¶∏‡¶¶‡¶∞ | Moulvibazar Sadar", "‡¶∞‡¶æ‡¶ú‡¶®‡¶ó‡¶∞ | Rajnagar", "‡¶ï‡ßÅ‡¶≤‡¶æ‡¶â‡¶°‡¶º‡¶æ | Kulaura", "‡¶ú‡ßÅ‡¶°‡¶º‡ßÄ | Juri", "‡¶¨‡¶°‡¶º‡¶≤‡ßá‡¶ñ‡¶æ | Barlekha", "‡¶ï‡¶Æ‡¶≤‡¶ó‡¶û‡ßç‡¶ú | Kamalganj", "‡¶∂‡ßç‡¶∞‡ßÄ‡¶Æ‡¶ô‡ßç‡¶ó‡¶≤ | Sreemangal"],
  "‡¶π‡¶¨‡¶ø‡¶ó‡¶û‡ßç‡¶ú | Habiganj": ["‡¶π‡¶¨‡¶ø‡¶ó‡¶û‡ßç‡¶ú ‡¶∏‡¶¶‡¶∞ | Habiganj Sadar", "‡¶®‡¶¨‡ßÄ‡¶ó‡¶û‡ßç‡¶ú | Nabiganj", "‡¶Ü‡¶ú‡¶Æ‡¶ø‡¶∞‡ßÄ‡¶ó‡¶û‡ßç‡¶ú | Ajmiriganj", "‡¶¨‡¶æ‡¶®‡¶ø‡¶Ø‡¶º‡¶æ‡¶ö‡¶Ç | Baniachong", "‡¶≤‡¶æ‡¶ñ‡¶æ‡¶á | Lakhai", "‡¶ö‡ßÅ‡¶®‡¶æ‡¶∞‡ßÅ‡¶ò‡¶æ‡¶ü | Chunarughat", "‡¶Æ‡¶æ‡¶ß‡¶¨‡¶™‡ßÅ‡¶∞ | Madhabpur", "‡¶¨‡¶æ‡¶π‡ßÅ‡¶¨‡¶≤ | Bahubal", "‡¶∂‡¶æ‡¶Ø‡¶º‡ßá‡¶∏‡ßç‡¶§‡¶æ‡¶ó‡¶û‡ßç‡¶ú | Shayestaganj"],
  "‡¶∏‡ßÅ‡¶®‡¶æ‡¶Æ‡¶ó‡¶û‡ßç‡¶ú | Sunamganj": ["‡¶∏‡ßÅ‡¶®‡¶æ‡¶Æ‡¶ó‡¶û‡ßç‡¶ú ‡¶∏‡¶¶‡¶∞ | Sunamganj Sadar", "‡¶¶‡¶ï‡ßç‡¶∑‡¶ø‡¶£ ‡¶∏‡ßÅ‡¶®‡¶æ‡¶Æ‡¶ó‡¶û‡ßç‡¶ú | Dakshin Sunamganj", "‡¶¨‡¶ø‡¶∂‡ßç‡¶¨‡¶Æ‡ßç‡¶≠‡¶∞‡¶™‡ßÅ‡¶∞ | Bishwamvarpur", "‡¶õ‡¶æ‡¶§‡¶ï | Chhatak", "‡¶¶‡ßã‡¶Ø‡¶º‡¶æ‡¶∞‡¶æ‡¶¨‡¶æ‡¶ú‡¶æ‡¶∞ | Dowarabazar", "‡¶§‡¶æ‡¶π‡¶ø‡¶∞‡¶™‡ßÅ‡¶∞ | Tahirpur", "‡¶ú‡¶æ‡¶Æ‡¶æ‡¶≤‡¶ó‡¶û‡ßç‡¶ú | Jamalganj", "‡¶¶‡¶ø‡¶∞‡¶æ‡¶á | Derai", "‡¶∂‡¶æ‡¶≤‡ßç‡¶≤‡¶æ | Shalla", "‡¶ß‡¶∞‡ßç‡¶Æ‡¶™‡¶æ‡¶∂‡¶æ | Dharmapasha", "‡¶Æ‡¶ß‡ßç‡¶Ø‡¶®‡¶ó‡¶∞ | Madhyanagar"]
};

function isNetworkOk() {
   if(!navigator.onLine) { toast("‚ùå ‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶®‡ßá‡¶ü ‡¶ï‡¶æ‡¶®‡ßá‡¶ï‡¶∂‡¶® ‡¶®‡ßá‡¶á! ‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶°‡ßá‡¶ü‡¶æ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶π‡¶ö‡ßç‡¶õ‡ßá‡•§"); return false; }
   return true;
}

// üì± PWA Install Prompt
let deferredPrompt;
window.addEventListener('beforeinstallprompt', (e) => {
  e.preventDefault();
  deferredPrompt = e;
  setTimeout(() => {
    if(deferredPrompt) toast("üì≤ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡¶ü‡¶ø ‡¶∏‡¶π‡¶ú‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶§‡ßá ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞ ‡¶Æ‡ßá‡¶®‡ßÅ ‡¶•‡ßá‡¶ï‡ßá 'Add to Home Screen' ‡¶ö‡¶æ‡¶™‡ßÅ‡¶®!", 5000);
  }, 30000);
});

window.onload = async function() {
  let d = new Date();
  document.getElementById('headerDate').innerText = d.toLocaleDateString('bn-BD', {day:'numeric', month:'long'}).replace(/\d/g, x=>bnDigits[x]);
  
  // ‚ö° 1. Fast Load from LocalStorage Cache (For instant accurate rendering)
  let cachedLoc = localStorage.getItem('iftarTracker_uLoc');
  if(cachedLoc) {
      uLoc = JSON.parse(cachedLoc);
      isLocationVerified = true;
  }
  
  if(!isNetworkOk()) {
      document.getElementById('locationStatus').innerHTML = "‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶®‡ßá‡¶ü ‡¶®‡ßá‡¶á! üìç ‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶® ‡¶Æ‡ßã‡¶°";
      initMap();
      return;
  }

  initMap();
  initDists();
  
  let cachedFeed = localStorage.getItem('iftarTracker_feed');
  if (cachedFeed) { feed = JSON.parse(cachedFeed); renderFeed(); renderPins(); }
  
  // ‚ö° 2. Start Real-time Sync & Location
  setupRealtime();
  fetchFeed(); 
  startLiveTracking(false);
};

// üßπ Auto-Delete Cache at Midnight (Fixed BD Time +6)
function checkMidnightWipe() {
    let bdTime = new Date(Date.now() + 6*3600000);
    let todayStr = bdTime.toISOString().split('T')[0];
    let lastDate = localStorage.getItem('iftarTracker_date');
    if (lastDate !== todayStr) {
        localStorage.removeItem('iftarTracker_feed');
        localStorage.setItem('iftarTracker_date', todayStr);
    }
}
checkMidnightWipe(); 

function setupRealtime() {
    _client.channel('public:iftar_updates').on('postgres_changes', { event: '*', schema: 'public', table: 'iftar_updates' }, () => {
        localStorage.removeItem('iftarTracker_feed'); // Cache bust
        fetchFeed(); 
        toast("üì¢ ‡¶®‡¶§‡ßÅ‡¶® ‡¶á‡¶´‡¶§‡¶æ‡¶∞ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶è‡¶∏‡ßá‡¶õ‡ßá!");
    }).subscribe();
}

async function openViewModal(pid, fly = false) {
  viewPost = feed.find(p => p.id === pid); if(!viewPost) return;
  if(fly && viewPost.mosques?.lat) map.flyTo([viewPost.mosques.lat, viewPost.mosques.lng], 19, {animate:true});
  
  fetch(__V__.u()+'/rest/v1/iftar_updates?id=eq.'+pid, {
      method:'PATCH', headers: __V__.h(), body: JSON.stringify({views: (viewPost.views||0) + 1})
  }).catch(()=>{});
  
  document.getElementById('viewModal').classList.remove('hidden');
  document.getElementById('viewMosqueName').innerText = viewPost.mosques?.name || '';
  document.getElementById('viewAddress').innerText = viewPost.mosques?.address || '';
  document.getElementById('viewItems').innerText = viewPost.items;
  
  document.getElementById('viewMosqueImg').classList.add('hidden'); document.getElementById('mosqueImgLoader').classList.remove('hidden');
  if(viewPost.mosques?.image_url) { let url = await getTgImg(viewPost.mosques.image_url); if(url) { document.getElementById('viewMosqueImg').src = url; document.getElementById('viewMosqueImg').classList.remove('hidden'); } }
  document.getElementById('mosqueImgLoader').classList.add('hidden');
  
  let fs = document.getElementById('foodImgSection');
  if(viewPost.food_image_url) {
    fs.classList.remove('hidden'); let fu = await getTgImg(viewPost.food_image_url); if(fu) document.getElementById('viewFoodImg').src = fu;
  } else fs.classList.add('hidden');
}

function openEdit() {
  if(!viewPost) return; 
  if(!isLocationVerified) { toast("‚ö†Ô∏è ‡¶ú‡¶ø‡¶™‡¶ø‡¶è‡¶∏ ‡¶Ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®!", 3000); return; }
  
  if(viewPost.mosques && viewPost.mosques.lat) {
      let dist = L.latLng(uLoc.lat, uLoc.lng).distanceTo(L.latLng(viewPost.mosques.lat, viewPost.mosques.lng));
      if(dist > 1000) return toast("‚ùå ‡¶Ü‡¶™‡¶®‡¶ø ‡¶è‡¶á ‡¶∏‡ßç‡¶•‡¶æ‡¶® ‡¶•‡ßá‡¶ï‡ßá ‡ßß ‡¶ï‡¶ø.‡¶Æ‡¶ø. ‡¶è‡¶∞ ‡¶¨‡¶æ‡¶á‡¶∞‡ßá ‡¶Ü‡¶õ‡ßá‡¶®‡•§ ‡¶è‡¶°‡¶ø‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá ‡¶®‡¶æ!"); 
  }
  
  closeModal();
  document.getElementById('editMosqueId').value = viewPost.mosques?.id || '';
  document.getElementById('mosqueName').value = viewPost.mosques?.name || ''; document.getElementById('mosqueName').disabled = true;
  
  let itmTxt = viewPost.items || "", pName = "", pPhone = "";
  if(itmTxt.startsWith('‡¶¶‡¶æ‡¶§‡¶æ: ')) { 
      let parts = itmTxt.split('\n‡¶Æ‡ßá‡¶®‡ßç‡¶Ø‡ßÅ: '); 
      let topRow = parts[0].replace('‡¶¶‡¶æ‡¶§‡¶æ: ', '').trim();
      let phoneSplit = topRow.split(' üìû ');
      pName = phoneSplit[0] || '';
      pPhone = phoneSplit[1] || '';
      itmTxt = parts[1] || ''; 
  }
  document.getElementById('providerName').value = pName; document.getElementById('providerName').disabled = true; 
  document.getElementById('providerPhone').value = pPhone; document.getElementById('providerPhone').disabled = true; 
  document.getElementById('iftarItems').value = itmTxt;
  document.getElementById('mosqueImgReq').innerText = '(‡¶ê‡¶ö‡ßç‡¶õ‡¶ø‡¶ï)';
  document.getElementById('formTitle').innerHTML = '<i class="fas fa-edit text-yellow-500"></i> ‡¶á‡¶´‡¶§‡¶æ‡¶∞ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®';
  document.getElementById('formSection').classList.remove('hidden');
  if(viewPost.mosques?.lat) map.flyTo([viewPost.mosques.lat, viewPost.mosques.lng], 18, {animate:true});
}

// üî• FLOATING REAL-TIME WALKING ROUTE LOGIC
function startRouting() {
  if(!viewPost || !viewPost.mosques || !viewPost.mosques.lat) return toast("‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø!");
  if(!isLocationVerified) { toast("‚ö†Ô∏è ‡¶Ü‡¶ó‡ßá ‡¶ú‡¶ø‡¶™‡¶ø‡¶è‡¶∏ ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶Ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®!", 4000); return startLiveTracking(true); }

  activeRouteTarget = { lat: viewPost.mosques.lat, lng: viewPost.mosques.lng };
  isRouteFirstDraw = true;

  closeModal(); 
  mapMovedByUser = true; // Disable lock

  document.getElementById('routeInfoOverlay').classList.remove('hidden');
  document.getElementById('routeInfoText').innerHTML = `<i class="fas fa-spinner fa-spin text-blue-500"></i> ‡¶ó‡ßÅ‡¶ó‡¶≤ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶™‡ßá‡¶∞ ‡¶Æ‡¶§‡ßã ‡¶∞‡ßÅ‡¶ü ‡¶ñ‡ßã‡¶Å‡¶ú‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...`;

  updateRouteOnMap();
}

function cancelRoute() {
  activeRouteTarget = null;
  if(routeLine) {
      if(routeLine.bg) map.removeLayer(routeLine.bg);
      if(routeLine.fg) map.removeLayer(routeLine.fg);
  }
  document.getElementById('routeInfoOverlay').classList.add('hidden');
}

let lastRouteTime = 0;
async function throttledUpdateRoute() {
  let now = Date.now();
  if(now - lastRouteTime < 5000) return;
  lastRouteTime = now;
  await updateRouteOnMap();
}

async function updateRouteOnMap() {
  if(!activeRouteTarget) return;
  let tLat = activeRouteTarget.lat, tLng = activeRouteTarget.lng;
  try {
    // üö∂ OSRM Foot Profile with Steps for Navigation
    let r = await fetch(`https://router.project-osrm.org/route/v1/foot/${uLoc.lng},${uLoc.lat};${tLng},${tLat}?overview=full&geometries=geojson&steps=true`);
    let data = await r.json();
    if(data.routes && data.routes[0]) {
        let route = data.routes[0];
        let bnD = (route.distance/1000).toFixed(2).replace(/\d/g, x=>bnDigits[x]);
        
        let durSecs = route.duration;
        let dH = Math.floor(durSecs/3600);
        let dM = Math.floor((durSecs%3600)/60);
        let dS = Math.floor(durSecs%60);
        let timeStr = "";
        if(dH > 0) timeStr += dH + " ‡¶ò‡¶£‡ßç‡¶ü‡¶æ ";
        timeStr += dM + " ‡¶Æ‡¶ø. " + dS + " ‡¶∏‡ßá.";
        let bnT = timeStr.replace(/\d/g, x=>bnDigits[x]);

        // üß≠ Turn-by-Turn Navigation Text
        let directionMsg = "‡¶∏‡ßã‡¶ú‡¶æ ‡¶Ø‡¶æ‡¶® ‚¨ÜÔ∏è";
        if(route.legs && route.legs[0] && route.legs[0].steps && route.legs[0].steps[1]) {
            let mod = route.legs[0].steps[1].maneuver.modifier || "";
            if(mod.includes('left')) directionMsg = "‡¶¨‡¶æ‡¶Æ‡ßá ‡¶Æ‡ßã‡ßú ‡¶®‡¶ø‡¶® ‚¨ÖÔ∏è";
            else if(mod.includes('right')) directionMsg = "‡¶°‡¶æ‡¶®‡ßá ‡¶Æ‡ßã‡ßú ‡¶®‡¶ø‡¶® ‚û°Ô∏è";
            else if(mod.includes('uturn')) directionMsg = "‡¶á‡¶â-‡¶ü‡¶æ‡¶∞‡ßç‡¶® ‡¶®‡¶ø‡¶® ‚Ü©Ô∏è";
        }
        
        document.getElementById('routeInfoText').innerHTML = `
            <div class="flex items-center gap-2 text-blue-800"><i class="fas fa-walking text-blue-600 text-lg"></i> ‡¶∞‡ßÅ‡¶ü: ${bnD} ‡¶ï‡¶ø.‡¶Æ‡¶ø.</div>
            <div class="flex items-center gap-2 text-gray-700 mt-0.5"><i class="fas fa-clock text-blue-500"></i> ‡¶∏‡¶Æ‡ßü: ~${bnT}</div>
            <div class="text-emerald-700 text-[11px] font-extrabold mt-1.5 bg-emerald-50 px-2 py-1 rounded-md inline-block border border-emerald-200 shadow-inner">üß≠ ‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ: ${directionMsg}</div>
        `;
        
        if(routeLine) {
            if(routeLine.bg) map.removeLayer(routeLine.bg);
            if(routeLine.fg) map.removeLayer(routeLine.fg);
        }
        
        // üî• Google Maps Style Solid Blue Line with Border
        let coords = route.geometry.coordinates.map(c=>[c[1],c[0]]);
        let bgLine = L.polyline(coords, {color:'#1a5ec4', weight:10, opacity:0.6}).addTo(map);
        let fgLine = L.polyline(coords, {color:'#00B3FD', weight:6, opacity:1}).addTo(map);
        routeLine = {bg: bgLine, fg: fgLine};
        
        if(isRouteFirstDraw) {
            map.fitBounds(bgLine.getBounds(), {padding: [50, 50], maxZoom: 17});
            isRouteFirstDraw = false;
        }
    }
  } catch(e) { 
      let d = (L.latLng(uLoc.lat, uLoc.lng).distanceTo(L.latLng(tLat, tLng))/1000).toFixed(2).replace(/\d/g, x=>bnDigits[x]);
      document.getElementById('routeInfoText').innerHTML = `<span class="text-blue-800">‚úàÔ∏è ‡¶∏‡ßã‡¶ú‡¶æ ‡¶¶‡ßÇ‡¶∞‡¶§‡ßç‡¶¨: ${d} ‡¶ï‡¶ø.‡¶Æ‡¶ø.</span>`; 
  }
}

async function doShare() {
  let link = window.location.origin + window.location.pathname + "?id=" + viewPost.id;
  let text = `üåô ‡¶á‡¶´‡¶§‡¶æ‡¶∞ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶ó‡ßá‡¶õ‡ßá!\nüìç ${viewPost.mosques?.name || '‡¶Ö‡¶ú‡¶æ‡¶®‡¶æ ‡¶∏‡ßç‡¶•‡¶æ‡¶®'}\nüçΩÔ∏è ‡¶Æ‡ßá‡¶®‡ßç‡¶Ø‡ßÅ: ${viewPost.items}\n\nüëâ Iftar Tracker BD ‡¶§‡ßá ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®:\n${link}`;
  if(navigator.share) {
      await navigator.share({ title: 'Iftar Tracker BD', text: text });
  } else { 
      navigator.clipboard.writeText(text); 
      toast("‚úÖ ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶ï‡¶™‡¶ø ‡¶π‡ßü‡ßá‡¶õ‡ßá!"); 
  }
}

async function uploadToTg(blob, fn) {
  let fd = new FormData(); fd.append('chat_id', __V__.c()); fd.append('photo', blob, fn);
  let r = await fetch('https://api.telegram.org/bot'+__V__.t()+'/sendPhoto', {method:'POST', body:fd});
  let d = await r.json(); return d.ok ? d.result.photo.pop().file_id : null;
}

async function getTgImg(fid) {
  if(!fid) return null;
  try {
    let r = await fetch('https://api.telegram.org/bot'+__V__.t()+'/getFile?file_id='+fid);
    let d = await r.json(); return d.ok ? 'https://api.telegram.org/file/bot'+__V__.t()+'/'+d.result.file_path : null;
  } catch(e){ return null; }
}

async function handleImg(input, type) {
    let file = input.files[0]; if(!file) return;
    document.getElementById(type+'ImageLabel').style.borderColor = "#10b981";
    let canvas = document.createElement('canvas');
    let img = new Image();
    img.onload = () => {
        let maxWidth = 800;
        let ratio = Math.min(maxWidth / img.width, 1);
        canvas.width = img.width * ratio;
        canvas.height = img.height * ratio;
        canvas.getContext('2d').drawImage(img, 0, 0, canvas.width, canvas.height);
        canvas.toBlob(b => { if(type==='mosque') mosqBlob=b; else foodBlob=b; }, 'image/webp', 0.6);
    };
    img.src = URL.createObjectURL(file);
}

// --- Map & Logic ---

function initMap() {
  map = L.map('map', { zoomControl: false, attributionControl: false }).setView([uLoc.lat, uLoc.lng], 16); 
  L.tileLayer('https://{s}.google.com/vt/lyrs=y&x={x}&y={y}&z={z}', { maxZoom: 21, subdomains: ['mt0', 'mt1', 'mt2', 'mt3'] }).addTo(map);
  
  markersGroup = L.markerClusterGroup({
      maxClusterRadius: 40,
      iconCreateFunction: (c) => L.divIcon({ html: `<div class="custom-cluster-icon w-12 h-12">${c.getChildCount()}</div>`, className: '', iconSize: [48, 48] })
  });
  map.addLayer(markersGroup);
  
  // üî• Google Maps Style Blue Dot
  let blueDot = L.divIcon({ className: 'custom-div-icon', html: `<div class="pulse-blue-dot"></div>`, iconSize:[0,0] });
  userMarker = L.marker([uLoc.lat, uLoc.lng], {icon: blueDot, zIndexOffset: 1000}).addTo(map);

  map.on('zoomend', () => {
     map.getContainer().setAttribute('data-zoom', map.getZoom());
  });
  map.getContainer().setAttribute('data-zoom', map.getZoom()); 

  map.on('movestart', () => { mapMovedByUser = true; });

  map.on('click', async e => {
    if(!isLocationVerified) return startLiveTracking(true);
    let lat = e.latlng.lat, lng = e.latlng.lng;
    
    let snapped = feed.find(p => p.mosques && p.mosques.lat && L.latLng(lat, lng).distanceTo(L.latLng(p.mosques.lat, p.mosques.lng)) < 30);
    if(snapped) return openViewModal(snapped.id, true);

    let dist = L.latLng(uLoc.lat, uLoc.lng).distanceTo(L.latLng(lat, lng));
    if(dist > 1000) {
        toast("‚ùå ‡¶Ü‡¶™‡¶®‡¶ø ‡¶Ö‡¶®‡ßá‡¶ï ‡¶¶‡ßÇ‡¶∞‡ßá! ‡¶∏‡¶†‡¶ø‡¶ï ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶®‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ï‡¶æ‡¶õ‡¶æ‡¶ï‡¶æ‡¶õ‡¶ø ‡¶ó‡¶ø‡ßü‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®‡•§", 4000);
        return;
    }

    selMapLoc = {lat, lng};
    document.getElementById('editMosqueId').value = '';
    document.getElementById('mosqueName').value = e.autoName || '';
    document.getElementById('mosqueName').disabled = false;
    document.getElementById('providerName').disabled = false;
    document.getElementById('providerName').value = '';
    document.getElementById('providerPhone').value = ''; 
    document.getElementById('mosqueImgReq').innerText = '*';
    document.getElementById('formTitle').innerHTML = '<i class="fas fa-map-pin text-red-500"></i> ‡¶®‡¶§‡ßÅ‡¶® ‡¶á‡¶´‡¶§‡¶æ‡¶∞ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®';
    document.getElementById('submitBtnText').innerText = '‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶® üöÄ';
    
    document.getElementById('formSection').classList.remove('hidden');
    if(clickMark) map.removeLayer(clickMark);
    
    let aIcon = L.divIcon({ className: 'custom-pin', html: `<i class="fas fa-map-marker-alt fa-3x" style="color: #ef4444;"></i>`, iconSize: [40, 40], iconAnchor: [20, 40] });
    clickMark = L.marker([lat, lng], {icon: aIcon}).addTo(map);
    
    try {
      let r = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&accept-language=bn`);
      let d = await r.json();
      if(!e.autoName) document.getElementById('mosqueName').value = d.address?.amenity || '';
      curAddr = d.display_name;
    } catch(err){}
    document.getElementById('formSection').scrollIntoView({behavior: 'smooth'});
  });
}

function manualLocTrigger() {
    activeRouteTarget = null; 
    if(routeLine) {
        if(routeLine.bg) map.removeLayer(routeLine.bg);
        if(routeLine.fg) map.removeLayer(routeLine.fg);
    }
    document.getElementById('routeInfoOverlay').classList.add('hidden');
    
    if (uLoc && uLoc.lat) {
        map.flyTo([uLoc.lat, uLoc.lng], 18, {animate:true, duration: 1}); 
    }
}

function requestLocationPrompt() {
    toast("‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶™‡¶æ‡¶∞‡¶Æ‡¶ø‡¶∂‡¶® ‡¶¶‡¶ø‡¶® üéØ", 3000);
    startLiveTracking(true);
}

function startLiveTracking(isManual = false) {
  if(!navigator.geolocation) return toast("GPS ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡ßá ‡¶®‡¶æ!");
  
  let locOverlay = document.getElementById('locationOverlay');
  if(locOverlay) locOverlay.classList.remove('hidden');
  document.getElementById('locationStatus').innerHTML = "GPS ‡¶ï‡¶æ‡¶®‡ßá‡¶ï‡ßç‡¶ü ‡¶π‡¶ö‡ßç‡¶õ‡ßá... üõ∞Ô∏è";

  trackId = navigator.geolocation.watchPosition(pos => {
      isLocationVerified = true;
      uLoc = {lat: pos.coords.latitude, lng: pos.coords.longitude};
      localStorage.setItem('iftarTracker_uLoc', JSON.stringify(uLoc)); // üî• Instant Cache Save
      userMarker.setLatLng([uLoc.lat, uLoc.lng]);
      
      if(!initialLocationSet) {
          map.flyTo([uLoc.lat, uLoc.lng], 18, {duration: 1});
          initialLocationSet = true;
          reverseGeocode(uLoc.lat, uLoc.lng, true);
      }
      
      document.getElementById('locationStatus').innerHTML = "üìç ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶π‡ßü‡ßá‡¶õ‡ßá!";
      // üî• Cleanly remove overlay after success
      setTimeout(() => { if(locOverlay) locOverlay.classList.add('hidden'); }, 1500);
      
      loadCountdown(uLoc.lat, uLoc.lng);
      renderFeed(); // Dynamically update feed distances
      
      if(activeRouteTarget) throttledUpdateRoute();

  }, (err) => {
      document.getElementById('locationStatus').innerHTML = "üìç ‡¶°‡¶ø‡¶´‡¶≤‡ßç‡¶ü: FF6V+G3 Baghchapa";
      setTimeout(() => { if(locOverlay) locOverlay.classList.add('hidden'); }, 2000);
      if(isManual) toast("‚ö†Ô∏è ‡¶´‡ßã‡¶®‡ßá GPS ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶Ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®!");
  }, {enableHighAccuracy: true, timeout: 5000, maximumAge: 0}); // Faster timeout
}

// ‚è±Ô∏è Advanced Aladhan Countdown & Notifications
function scheduleNotification(h, m) {
    if(!('Notification' in window)) return;
    if(Notification.permission === 'default') Notification.requestPermission();
    if(Notification.permission === 'granted') {
        let now = new Date();
        let iftar = new Date(); iftar.setHours(h, m, 0, 0);
        let timeToIftar = iftar - now;
        let alertTime = timeToIftar - (15 * 60000); // 15 mins before
        if(alertTime > 0) {
            setTimeout(() => {
                new Notification("üåô ‡¶á‡¶´‡¶§‡¶æ‡¶∞‡ßá‡¶∞ ‡¶∏‡¶Æ‡ßü ‡¶ò‡¶®‡¶ø‡ßü‡ßá ‡¶Ü‡¶∏‡¶õ‡ßá!", { body: "‡¶Ü‡¶∞ ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡ßß‡ß´ ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü ‡¶¨‡¶æ‡¶ï‡¶ø! ‡¶™‡ßç‡¶∞‡¶∏‡ßç‡¶§‡ßÅ‡¶§‡¶ø ‡¶®‡¶ø‡¶®‡•§" });
            }, alertTime);
        }
    }
}

async function loadCountdown(lat, lng) {
  let todayStr = new Date(Date.now() + 6*3600000).toISOString().split('T')[0];
  let cachedTime = JSON.parse(localStorage.getItem('iftarTracker_timing') || '{}');
  let mg24 = "";

  if(cachedTime.date === todayStr && cachedTime.lat === lat) {
      mg24 = cachedTime.time;
  } else {
      try {
        let r = await fetch(`https://api.aladhan.com/v1/timings?latitude=${lat}&longitude=${lng}&method=1`);
        let d = await r.json();
        mg24 = d.data.timings.Maghrib; 
        localStorage.setItem('iftarTracker_timing', JSON.stringify({date: todayStr, time: mg24, lat: lat}));
      } catch(e){ return; }
  }

  let [h, m] = mg24.split(':').map(Number);
  let ampm = h >= 12 ? 'PM' : 'AM'; 
  let h12 = h % 12 || 12;
  let timeStr = `${h12.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')} ${ampm}`.replace(/\d/g, x => bnDigits[x]);

  // Save for ending status check
  currentMaghribDate = new Date(); currentMaghribDate.setHours(h, m, 0, 0);

  scheduleNotification(h, m); // Schedule Push 15 mins before

  if(cdInterval) clearInterval(cdInterval);
  let bar = document.getElementById('iftarCountdownBar');
  bar.classList.remove('hidden');
  
  cdInterval = setInterval(() => {
    let now = new Date(), iftar = new Date();
    iftar.setHours(h, m, 0, 0);
    let diff = iftar - now;
    if(diff > 0) {
      let hrs = Math.floor(diff/3600000), mins = Math.floor((diff%3600000)/60000), secs = Math.floor((diff%60000)/1000);
      let hStr = hrs > 0 ? hrs.toString().padStart(2, '0') + ' ‡¶ò‡¶£‡ßç‡¶ü‡¶æ ' : '';
      let tStr = (hStr + mins.toString().padStart(2, '0') + ' ‡¶Æ‡¶ø. ' + secs.toString().padStart(2, '0') + ' ‡¶∏‡ßá.').replace(/\d/g, x => bnDigits[x]);
      bar.innerHTML = `üåô ‡¶á‡¶´‡¶§‡¶æ‡¶∞ ‡¶¨‡¶æ‡¶ï‡¶ø: ${tStr} | ‡¶Ü‡¶ú‡¶æ‡¶®: ${timeStr}`;
    } else {
      bar.innerHTML = `‚úÖ ‡¶Ü‡¶≤‡¶π‡¶æ‡¶Æ‡¶¶‡ßÅ‡¶≤‡¶ø‡¶≤‡ßç‡¶≤‡¶æ‡¶π! ‡¶á‡¶´‡¶§‡¶æ‡¶∞‡ßá‡¶∞ ‡¶∏‡¶Æ‡ßü ‡¶π‡ßü‡ßá ‡¶ó‡ßá‡¶õ‡ßá (${timeStr})`;
      clearInterval(cdInterval);
    }
  }, 1000);
}

// --- Helpers ---

async function flyToAdminArea(query, zoomLevel) {
  try {
    let locOverlay = document.getElementById('locationOverlay');
    if(locOverlay) locOverlay.classList.remove('hidden');
    document.getElementById('locationStatus').innerHTML = "‡¶Æ‡ßç‡¶Ø‡¶æ‡¶™‡ßá ‡¶ñ‡ßã‡¶Å‡¶ú‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá... üöÅ";
    let r = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(query)}&limit=1`);
    let d = await r.json();
    if(d && d.length > 0) {
      map.flyTo([d[0].lat, d[0].lon], zoomLevel, { animate: true, duration: 1.5 });
      document.getElementById('locationStatus').innerHTML = "üìç " + d[0].display_name.split(',')[0];
    }
    setTimeout(() => { if(locOverlay) locOverlay.classList.add('hidden'); }, 1500);
  } catch(e) {}
}

async function reverseGeocode(lat, lng, prioritize = false) {
  try {
    let r = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&accept-language=bn`);
    let d = await r.json();
    curAddr = d.display_name;
    if(prioritize && d.address) {
      let apiState = d.address.state || d.address.region || "";
      let apiCounty = d.address.county || d.address.suburb || d.address.town || d.address.city || "";
      
      let matchedDist = Object.keys(GEO).find(k => k.toLowerCase().includes(apiState.toLowerCase().replace(' district', '')));
      if(matchedDist) {
          selDist = matchedDist.split('|')[0].trim();
          document.getElementById('distBtnText').innerText = selDist;
          let matchedUpz = GEO[matchedDist].find(u => u.toLowerCase().includes(apiCounty.toLowerCase().replace(' upazila', '')));
          if(matchedUpz) {
              selUpz = matchedUpz.split('|')[0].trim();
              document.getElementById('upzBtnText').innerText = selUpz;
              document.getElementById('upzBtn').disabled = false;
              document.getElementById('upzBtn').classList.remove('opacity-50');
              document.getElementById('villageInput').disabled = false;
          }
      }
      fetchNearbyMosques(lat, lng);
    }
  } catch(e){}
}

async function fetchNearbyMosques(lat, lng) {
   let q = `[out:json];node["amenity"="place_of_worship"]["religion"="muslim"](around:1000,${lat},${lng});out 5;`;
   try {
     let r = await fetch(`https://overpass-api.de/api/interpreter?data=${encodeURIComponent(q)}`);
     let d = await r.json();
     if(d.elements.length > 0) {
        document.getElementById('nearbyContainer').classList.remove('hidden');
        let html = '';
        d.elements.forEach(el => {
           if(el.tags && el.tags.name) {
              let hasIftar = feed.some(p => p.mosques && p.mosques.lat && L.latLng(el.lat, el.lon).distanceTo(L.latLng(p.mosques.lat, p.mosques.lng)) < 50);
              if (!hasIftar) {
                  html += `<button onclick="flyAndOpenForm(${el.lat}, ${el.lon}, '${el.tags.name.replace(/'/g,"\\'")}')" class="bg-red-50 border border-red-200 text-red-800 text-[10px] font-bold px-3 py-1.5 rounded-full shadow-sm hover:bg-red-100 transition-colors shrink-0"><i class="fas fa-exclamation-circle text-red-500 mr-1"></i> ${el.tags.name} (‡¶á‡¶´‡¶§‡¶æ‡¶∞ ‡¶®‡ßá‡¶á)</button>`;
              } else {
                  html += `<button onclick="flyAndOpenForm(${el.lat}, ${el.lon}, '${el.tags.name.replace(/'/g,"\\'")}')" class="bg-emerald-50 border border-emerald-200 text-emerald-800 text-[10px] font-bold px-3 py-1.5 rounded-full shadow-sm hover:bg-emerald-100 transition-colors shrink-0"><i class="fas fa-check-circle text-emerald-500 mr-1"></i> ${el.tags.name} (‡¶á‡¶´‡¶§‡¶æ‡¶∞ ‡¶Ü‡¶õ‡ßá)</button>`;
              }
           }
        });
        document.getElementById('nearbyList').innerHTML = html;
     }
   } catch(e) {}
}

function flyAndOpenForm(lat, lng, name) {
   map.flyTo([lat, lng], 19, {animate: true});
   map.fire('click', {latlng: {lat: lat, lng: lng}, autoName: name});
}

function getBnName(fullStr) { return fullStr.split('|')[0].trim(); }

function mkLi(fullText, cb, isPriority = false) {
  let bnText = getBnName(fullText);
  let li = document.createElement('li');
  li.dataset.search = fullText.toLowerCase();
  li.className = `p-3 cursor-pointer border-b border-gray-100 transition-colors ${isPriority ? 'bg-emerald-100 font-bold text-emerald-900' : 'text-gray-800 hover:bg-emerald-50'}`;
  li.innerHTML = isPriority ? `üìç ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶®: ${bnText}` : bnText;
  li.onclick = () => cb(fullText);
  return li;
}

function initDists(priority = false) {
  let ul = document.getElementById('distUl'); ul.innerHTML = '';
  let dKeys = Object.keys(GEO).sort();
  let foundDist = "";
  if(priority && curDistStr) {
    foundDist = dKeys.find(k => k.includes(curDistStr));
    if(foundDist) ul.appendChild(mkLi(foundDist, selDistrict, true));
  }
  dKeys.forEach(d => { if(d !== foundDist) ul.appendChild(mkLi(d, selDistrict)); });
}

function selDistrict(dFull) {
  selDist = getBnName(dFull); 
  document.getElementById('distBtnText').innerText = selDist;
  document.getElementById('distList').classList.add('hidden');
  
  selUpz = ''; document.getElementById('upzBtnText').innerText = '‡¶â‡¶™‡¶ú‡ßá‡¶≤‡¶æ';
  let vInp = document.getElementById('villageInput');
  vInp.disabled = true; vInp.placeholder = "‡¶Ü‡¶ó‡ßá ‡¶â‡¶™‡¶ú‡ßá‡¶≤‡¶æ ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®";
  
  let ul = document.getElementById('upzUl'); ul.innerHTML = '';
  let foundUpz = "";
  if(curUpzStr) {
     foundUpz = GEO[dFull].find(u => u.includes(curUpzStr));
     if(foundUpz) ul.appendChild(mkLi(foundUpz, selUpazila, true));
  }
  GEO[dFull].sort().forEach(u => { if(u !== foundUpz) ul.appendChild(mkLi(u, selUpazila)); });
  
  document.getElementById('upzBtn').disabled = false; 
  document.getElementById('upzBtn').classList.remove('opacity-50', 'cursor-not-allowed');

  flyToAdminArea(`${selDist} District, Bangladesh`, 10);
  renderFeed();
}

function selUpazila(uFull) {
  selUpz = getBnName(uFull); 
  document.getElementById('upzBtnText').innerText = selUpz;
  document.getElementById('upzList').classList.add('hidden');
  let vInp = document.getElementById('villageInput');
  vInp.disabled = false; vInp.classList.remove('opacity-50');
  vInp.placeholder = "‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶¨‡¶æ ‡¶ó‡ßÅ‡¶ó‡¶≤ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶™ ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶™‡ßá‡¶∏‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®..."; vInp.focus();

  flyToAdminArea(`${selUpz}, ${selDist}, Bangladesh`, 13);
  renderFeed();
}

// ----------------

function timeAgo(dateStr) {
    if(!dateStr) return '‡¶Ü‡¶ú';
    let mins = Math.floor((Date.now() - new Date(dateStr).getTime()) / 60000);
    if(mins < 1) return '‡¶è‡¶á‡¶Æ‡¶æ‡¶§‡ßç‡¶∞';
    if(mins < 60) return `${mins} ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü ‡¶Ü‡¶ó‡ßá`.replace(/\d/g, x=>bnDigits[x]);
    return `${Math.floor(mins/60)} ‡¶ò‡¶£‡ßç‡¶ü‡¶æ ‡¶Ü‡¶ó‡ßá`.replace(/\d/g, x=>bnDigits[x]);
}

async function fetchFeed() {
  try {
    let todayStr = new Date(Date.now() + 6*3600000).toISOString().split('T')[0];
    let r = await fetch(__V__.u()+`/rest/v1/iftar_updates?select=*,mosques(id,name,address,lat,lng,image_url)&date=eq.${todayStr}&order=id.desc`, {headers: __V__.h()});
    if(r.ok) { 
      feed = await r.json(); 
      localStorage.setItem('iftarTracker_feed', JSON.stringify(feed)); 
      renderFeed(); 
      renderPins(); 
    }
  } catch(e){}
}

function renderFeed() {
  let c = document.getElementById('feedContainer');
  let filterEl = document.getElementById('feedLocationFilter');
  
  // üî• ‡¶®‡¶ø‡¶ú‡ßá‡¶∞ ‡¶ú‡ßá‡¶≤‡¶æ ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡ßü‡ßÄ ‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡ßç‡¶ü ‡¶´‡¶ø‡¶≤‡ßç‡¶ü‡¶æ‡¶∞‡¶ø‡¶Ç
  let activeDist = selDist || curDistStr; 
  let fFeed = feed; 

  if(activeDist) {
      fFeed = feed.filter(p => p.mosques && p.mosques.address && p.mosques.address.includes(activeDist));
  }

  if(selUpz) { 
      fFeed = fFeed.filter(p => p.mosques && p.mosques.address && p.mosques.address.includes(selUpz));
      filterEl.innerText = `(${selUpz})`; 
      filterEl.classList.remove('hidden'); 
  } else if (activeDist) {
      filterEl.innerText = `(${activeDist})`; 
      filterEl.classList.remove('hidden'); 
  } else { 
      filterEl.classList.add('hidden'); 
  }

  fFeed = fFeed.map(p => {
      let distKm = 9999;
      if(p.mosques && p.mosques.lat && uLoc.lat) {
          distKm = L.latLng(uLoc.lat, uLoc.lng).distanceTo(L.latLng(p.mosques.lat, p.mosques.lng)) / 1000;
      }
      return {...p, distKm};
  }).sort((a,b) => a.distKm - b.distKm);

  if(!fFeed.length) { c.innerHTML = '<div class="text-center p-8 bg-white rounded-3xl"><i class="fas fa-box-open text-4xl text-gray-300 mb-3"></i><p class="text-sm font-bold text-gray-500">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶è‡¶≤‡¶æ‡¶ï‡¶æ‡ßü ‡¶Ü‡¶ú ‡¶ï‡ßã‡¶®‡ßã ‡¶á‡¶´‡¶§‡¶æ‡¶∞ ‡¶®‡ßá‡¶á!</p></div>'; return; }
  
  c.innerHTML = fFeed.map(p => {
    if (!p.mosques) return ''; 
    
    let bnDist = (p.distKm < 1 ? (p.distKm*1000).toFixed(0) + ' ‡¶Æ‡¶ø.' : p.distKm.toFixed(2) + ' ‡¶ï‡¶ø.‡¶Æ‡¶ø.').replace(/\d/g, x=>bnDigits[x]);
    
    // ‚è±Ô∏è Hour Minute Second Format for Feed
    let totalSecs = Math.round(p.distKm * 12 * 60); 
    let dH = Math.floor(totalSecs / 3600);
    let dM = Math.floor((totalSecs % 3600) / 60);
    let dS = totalSecs % 60;
    let timeStr = "";
    if(dH > 0) timeStr += dH + " ‡¶ò‡¶£‡ßç‡¶ü‡¶æ ";
    timeStr += dM + " ‡¶Æ‡¶ø. " + dS + " ‡¶∏‡ßá.";
    let bnTime = timeStr.replace(/\d/g, x=>bnDigits[x]); 

    let isEnded = false;
    if(currentMaghribDate) {
        let iftarEndTime = new Date(currentMaghribDate.getTime() + 30*60000); 
        isEnded = new Date() > iftarEndTime;
    }
    let statusBadge = isEnded ? '<span class="text-red-500 font-bold ml-2">‚ö´ ‡¶∂‡ßá‡¶∑</span>' : '<span class="text-emerald-500 font-bold ml-2">üü¢ ‡¶ö‡¶≤‡¶õ‡ßá</span>';

    let tAgo = timeAgo(p.created_at);
    let viewsCount = p.views ? p.views.toString().replace(/\d/g, x=>bnDigits[x]) : '‡ß¶';
    let mName = p.mosques.name || '‡¶Ö‡¶ú‡¶æ‡¶®‡¶æ ‡¶∏‡ßç‡¶•‡¶æ‡¶®';
    let mAddr = p.mosques.address || '‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ ‡¶®‡ßá‡¶á';

    return `
    <div onclick="openViewModal('${p.id}')" class="glass-panel p-5 rounded-3xl shadow-sm cursor-pointer relative overflow-hidden group mb-4">
      <div class="flex justify-between items-start">
        <div class="pr-24">
          <h3 class="font-extrabold text-emerald-950 text-sm">${mName} ${statusBadge}</h3>
          <p class="text-[10px] text-gray-500 mt-1 flex items-center gap-1"><i class="fas fa-map-marker-alt text-emerald-600"></i> ${mAddr}</p>
        </div>
        <div class="absolute top-5 right-4 text-right">
          <div class="bg-emerald-100 text-emerald-900 text-[10px] font-bold px-2 py-1 rounded-lg border border-emerald-200 mb-1 transition-all duration-300">${bnDist}</div>
          <div class="text-[9px] font-bold text-gray-500 transition-all duration-300"><i class="fas fa-walking text-emerald-600"></i> ${bnTime}</div>
        </div>
      </div>
      <div class="bg-white/60 p-3 rounded-2xl border border-white mt-3 text-xs font-bold text-gray-800 line-clamp-2">üç≤ ${p.items || '‡¶Æ‡ßá‡¶®‡ßç‡¶Ø‡ßÅ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡ßü‡¶®‡¶ø'}</div>
      <div class="flex justify-between mt-2 px-1">
        <span class="text-[9px] text-gray-400 font-bold"><i class="fas fa-clock"></i> ${tAgo}</span>
        <span class="text-[9px] text-blue-400 font-bold"><i class="fas fa-eye"></i> ${viewsCount} ‡¶ú‡¶® ‡¶¶‡ßá‡¶ñ‡ßá‡¶õ‡ßá‡¶®</span>
      </div>
    </div>
  `}).join('');
}

function renderPins() {
  if(!markersGroup) return; markersGroup.clearLayers();
  feed.forEach(p => {
    if (!p.mosques || !p.mosques.lat || !p.mosques.lng) return; 
    let mName = p.mosques.name || '‡¶Ö‡¶ú‡¶æ‡¶®‡¶æ ‡¶∏‡ßç‡¶•‡¶æ‡¶®';
    let itemsShort = p.items ? p.items.split('\n')[0].substring(0, 30) : '‡¶á‡¶´‡¶§‡¶æ‡¶∞ ‡¶Ü‡¶õ‡ßá';
    
    let icon = L.divIcon({ 
        className: 'custom-div-icon', 
        html: `<div class="map-text-marker" onclick="openViewModal('${p.id}')">
                 <i class="fas fa-map-marker-alt pin-icon"></i>
                 <div class="info-text">${mName}</div>
                 <div class="menu-text text-yellow-300 text-[10px] font-bold mt-1 bg-black/60 px-1.5 py-0.5 rounded-md backdrop-blur-sm line-clamp-1">üç≤ ${itemsShort}</div>
               </div>`, 
        iconSize:[0,0] 
    });
    markersGroup.addLayer(L.marker([p.mosques.lat, p.mosques.lng], {icon: icon}));
  });
}

function toggleDD(id) { document.getElementById(id).classList.toggle('hidden'); }

function filterList(i, u) { 
    let v = document.getElementById(i).value.toLowerCase();
    document.getElementById(u).querySelectorAll('li').forEach(li => {
      li.style.display = li.dataset.search.includes(v) ? '' : 'none';
    });
}

let _vt; function debounceVillage() { clearTimeout(_vt); _vt = setTimeout(execVillageSearch, 400); }
async function execVillageSearch() {
  let val = document.getElementById('villageInput').value.trim();
  let sb = document.getElementById('villageSugg');
  
  if(val.length < 1) { sb.classList.add('hidden'); return; }

  let gmMatch = val.match(/@(-?\d+\.\d+),(-?\d+\.\d+)/) || val.match(/q=(-?\d+\.\d+),(-?\d+\.\d+)/);
  if(gmMatch) {
      let pLat = parseFloat(gmMatch[1]), pLng = parseFloat(gmMatch[2]);
      map.flyTo([pLat, pLng], 19, {animate:true});
      document.getElementById('locationStatus').innerHTML = 'üìç ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶®';
      reverseGeocode(pLat, pLng);
      sb.classList.add('hidden');
      return;
  }
  
  let locOverlay = document.getElementById('locationOverlay');
  if(locOverlay) locOverlay.classList.remove('hidden');
  document.getElementById('locationStatus').innerHTML = "‡¶ñ‡ßÅ‡¶Å‡¶ú‡¶õ‡¶ø... üöÅ";
  sb.innerHTML = '<li class="p-4 text-center text-emerald-700 font-bold"><i class="fas fa-spinner fa-spin text-xl"></i> ‡¶ñ‡ßÅ‡¶Å‡¶ú‡¶õ‡¶ø...</li>';
  sb.classList.remove('hidden');
  
  try {
    let b = map.getBounds();
    let viewbox = `${b.getWest()},${b.getSouth()},${b.getEast()},${b.getNorth()}`;
    
    let query = val;
    if(selUpz) query = `${val} ${selUpz}`;
    else if(selDist) query = `${val} ${selDist}`;

    let url = `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(query)}&countrycodes=bd&viewbox=${viewbox}&bounded=1&accept-language=bn&limit=5`;
    let r = await fetch(url);
    let data = await r.json(); 

    if(data.length === 0) {
        let fallbackQuery = selDist ? `${val}, ${selDist}, Bangladesh` : `${val}, Bangladesh`;
        let r2 = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(fallbackQuery)}&countrycodes=bd&accept-language=bn&limit=5`);
        data = await r2.json();
    }

    sb.innerHTML = '';
    setTimeout(() => { if(locOverlay) locOverlay.classList.add('hidden'); }, 1000);

    if(data.length) {
      data.forEach(pl => {
        let li = document.createElement('li'); 
        li.className = "p-4 cursor-pointer border-b border-gray-100 hover:bg-emerald-50 flex items-start gap-3 transition-colors";
        li.innerHTML = `<i class="fas fa-map-marker-alt text-emerald-600 mt-1 text-xl"></i><div class="flex-1 text-left"><div class="text-emerald-950 font-extrabold text-sm leading-tight">${pl.name}</div><div class="text-gray-500 text-[10px] font-medium leading-tight mt-1 line-clamp-2">${pl.display_name}</div></div>`;
        li.onclick = () => { 
            map.flyTo([pl.lat, pl.lon], 19, {animate:true, duration: 1.5}); 
            curAddr = pl.display_name; 
            sb.classList.add('hidden'); 
            document.getElementById('villageInput').value = pl.name; 
            fetchNearbyMosques(pl.lat, pl.lon);
        };
        sb.appendChild(li);
      });
    } else { 
        sb.innerHTML = '<li class="p-4 text-center text-sm text-red-500 font-bold">‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø! ‡¶∏‡¶†‡¶ø‡¶ï ‡¶¨‡¶æ‡¶®‡¶æ‡¶® ‡¶¶‡¶ø‡¶®‡•§</li>'; 
    }
  } catch(e) { 
      sb.innerHTML = '<li class="p-4 text-center text-sm text-gray-500 font-bold">‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶®‡ßá‡¶ü ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ‡•§</li>'; 
      setTimeout(() => { if(locOverlay) locOverlay.classList.add('hidden'); }, 1000);
  }
}

function hideForm() { document.getElementById('formSection').classList.add('hidden'); if(clickMark) map.removeLayer(clickMark); document.getElementById('iftarForm').reset(); mosqBlob=null; foodBlob=null; }
function closeModal() { document.getElementById('viewModal').classList.add('hidden'); }
function toast(m, t=3000) { let d = document.createElement('div'); d.className='toast'; d.innerText=m; document.body.appendChild(d); setTimeout(()=>d.remove(), t); }

document.getElementById('iftarForm').onsubmit = async (e) => {
    e.preventDefault();
    let btn = document.getElementById('submitBtn'); btn.disabled = true; btn.innerText = "‡¶∏‡ßá‡¶≠ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...";
    try {
        let todayStr = new Date(Date.now() + 6*3600000).toISOString().split('T')[0];
        let pName = document.getElementById('providerName').value, pPhone = document.getElementById('providerPhone').value, mName = document.getElementById('mosqueName').value, items = document.getElementById('iftarItems').value;
        
        let tgM = mosqBlob ? await uploadToTg(mosqBlob, 'msq.webp') : null;
        let tgF = foodBlob ? await uploadToTg(foodBlob, 'food.webp') : null;

        let mid = document.getElementById('editMosqueId').value;
        if(!mid) {
            let res = await fetch(__V__.u()+'/rest/v1/mosques', {method:'POST', headers:__V__.h(), body:JSON.stringify({name:mName, lat:selMapLoc.lat, lng:selMapLoc.lng, address:curAddr, image_url: tgM})});
            let data = await res.json(); mid = data[0].id;
        } else if(tgM) {
            await fetch(__V__.u()+'/rest/v1/mosques?id=eq.'+mid, {method:'PATCH', headers:__V__.h(), body:JSON.stringify({image_url: tgM})});
        }
        
        await fetch(__V__.u()+'/rest/v1/iftar_updates', {method:'POST', headers:Object.assign({}, __V__.h(), {'Prefer':'resolution=merge-duplicates'}), body:JSON.stringify({mosque_id: mid, date: todayStr, food_image_url: tgF, items: `‡¶¶‡¶æ‡¶§‡¶æ: ${pName} üìû ${pPhone}\n‡¶Æ‡ßá‡¶®‡ßç‡¶Ø‡ßÅ: ${items}`})});
        
        localStorage.removeItem('iftarTracker_feed');
        await fetchFeed(); 
        
        confetti({ particleCount: 200, spread: 70, origin: { y: 0.6 }, zIndex: 3000 });
        hideForm(); toast("‚úÖ ‡¶á‡¶´‡¶§‡¶æ‡¶∞ ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
    } catch(err) { toast("‚ùå ‡¶è‡¶∞‡¶∞ ‡¶π‡ßü‡ßá‡¶õ‡ßá!"); }
    btn.disabled = false; btn.innerText = "‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶® üöÄ";
};
</script>
</body>
</html>